<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Securelist - Information about Viruses, Hackers and Spam</title>
	<atom:link href="http://securelist.com/feed/" rel="self" type="application/rss+xml" />
	<link>http://securelist.com</link>
	<description>Online headquarters of Kaspersky Lab security experts.</description>
	<lastBuildDate>Wed, 18 May 2016 11:17:48 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.5.2</generator>

<image>
	<url>http://securelist.com/wp-content/themes/securelist/images/site-icon.png</url>
	<title>Securelist - Information about Viruses, Hackers and Spam</title>
	<link>http://securelist.com</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>ATM infector</title>
		<link>http://securelist.com/blog/research/74772/atm-infector/</link>
		<comments>http://securelist.com/blog/research/74772/atm-infector/#respond</comments>
		<pubDate>Tue, 17 May 2016 10:57:55 +0000</pubDate>
		<dc:creator><![CDATA[GReAT]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[Research]]></category>
		<category><![CDATA[APT]]></category>
		<category><![CDATA[ATM attacks]]></category>
		<category><![CDATA[Cybercrime]]></category>

		<guid isPermaLink="false">https://kasperskycontenthub.com/securelist/?p=74772</guid>
		<description><![CDATA[In 2009, instead of infecting the computers of users worldwide, criminals went directly after the ATM itself – infecting it with malware called Skimer. Seven years later, our experts discovered a new, improved, version of Skimer.]]></description>
				<content:encoded><![CDATA[<p><img width="400" height="280" src="http://securelist.com/wp-content/themes/securelist/images/article-default/abstraction_7.jpg" class="attachment-post-thumbnail wp-post-image no-image" alt="no-image"></p><p>Seven years ago, in 2009, we saw a completely new type of attack on banks. Instead of infecting the computers of thousands of users worldwide, criminals went directly after the ATM itself – infecting it with malware called Skimer. Seven years later, our Global Research and Analysis Team together with Penetration Testing Team have been called on for an incident response. They discovered a new, improved, version of Skimer. </p>
<h2 id="virus-style-infections">Virus style infections </h2>
<p>Criminals often obscured their malware with packers to make analysis more difficult for researchers. The criminals behind Skimer also did this, using the commercially available packer Themida, which packs both the infector and the dropper. </p>
<p>Once the malware is executed it checks if the file system is FAT32. If it is, it drops the file netmgr.dll in the folder C:\Windows\System32. If it is an NTFS file system, the same file will be placed in the NTFS data stream corresponding to the XFS service´s executable file. Placing the file in an NTFS data stream is most likely done to make forensic analysis more difficult.</p>
<p>After successful installation, the sample patches the XFS executable (SpiService.exe) entry point, in order to add a LoadLibrary call to the dropped netmgr.dll file. This file is also protected by Themida.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/atminfector_en_1.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/atminfector_en_1.png" alt="ATM infector" width="654" height="262" class="aligncenter size-full wp-image-74777" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Entry point in SpiService.exe before infection</em></p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/atminfector_en_3.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/atminfector_en_3-1024x265.png" alt="ATM infector" width="604" height="156" class="aligncenter size-large wp-image-74779" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Entry point in SpiService.exe after infection</em></p>
<p>After a successful installation the ATM is rebooted. The malicious library will be loaded into the SpiService.exe thanks to the new LoadLibrary call, providing it with full access to XFS.</p>
<h2 id="functionality">Functionality</h2>
<p>Unlike <a href="https://securelist.com/blog/research/66988/tyupkin-manipulating-atm-machines-with-%20malware/">Tyupkin</a>, where there was a magic code and a specific time frame where the malware was active, Skimer only wakes up when a magic card (specific Track 2 data, see IOCs at the bottom of this blogpost) is inserted. It is a smart way to implement access control to the malware&#8217;s functionality. </p>
<p>Once the magic card is inserted, the malware is ready to interact with two different types of cards, each with different functions:</p>
<ol>
<li>Card type 1 – request commands through the interface</li>
<li>Card type 2 – execute the command hardcoded in the Track2</li>
</ol>
<p>After the card is ejected, the user will be presented with a form, asking them to insert the session key in less than 60 seconds. Now the user is authenticated, and the malware will accept 21 different codes for setting its activity. These codes should be entered from the pin pad. </p>
<p>Below is a list of the most important features:</p>
<ol>
<li>Show installation details;</li>
<li>Dispense money – 40 notes from the specified cassette;</li>
<li>Start collecting the details of inserted cards;</li>
<li>Print collected card details;</li>
<li>Self delete;</li>
<li>Debug mode;</li>
<li>Update (the updated malware code is embedded on the card).</li>
</ol>
<p>During its activity, the malware also creates the following files or NTFS streams (depending on the file system type). These files are used by the malware at different stages of its activity, such as storing the configuration, storing skimmed card data and logging its activity:</p>
<table border="0">
<tr>
<td>C:\Windows\Temp\attrib1</td>
<td style="padding-left:10px">card data collected from network traffic or from the card reader;</td>
</tr>
<tr>
<td style="vertical-align: top">C:\Windows\Temp\attrib4</td>
<td rowspan="2" style="padding-left:10px">logs data from different APIs responsible for the communication with the keyboard (effectively logging data such as the pin);</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>C:\Windows\Temp\mk32</td>
<td style="padding-left:10px">same as attrib4;</td>
</tr>
<tr>
<td>C:\Windows\Temp:attrib1</td>
<td style="padding-left:10px">same as the homologue file;</td>
</tr>
<tr>
<td>C:\Windows\Temp:attrib4</td>
<td style="padding-left:10px">same as the homologue file;</td>
</tr>
<tr>
<td>C:\Windows\Temp:mk32</td>
<td style="padding-left:10px">same as the homologue file;</td>
</tr>
<tr>
<td>C:\Windows\Temp:opt</td>
<td style="padding-left:10px">logs mule´s activity.</td>
</tr>
</table>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/atminfector_en_5.jpg" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/atminfector_en_5-893x1024.jpg" alt="ATM infector" width="604" height="693" class="aligncenter size-large wp-image-74781" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Main window</em></p>
<p>The following video details the scenario on how money mules interact with an infected ATM as described above.</p>
<iframe class='youtube-player' type='text/html' width='560' height='315' src='http://www.youtube.com/embed/hOcFy02c7x0?version=3&#038;rel=1&#038;fs=1&#038;autohide=2&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;wmode=transparent' allowfullscreen='true' style='border:0;'></iframe>
<h2 id="conclusions">Conclusions</h2>
<p>During our recent Incident Response cases related to the abuse of ATMs, we have identified <a href="https://securelist.com/blog/research/66988/tyupkin-manipulating-atm-machines-with-%20malware/">Tyupkin</a>, <a href="https://securelist.com/blog/research/68732/the-great-bank-robbery-the-carbanak-apt/">Carbanak</a><sup> </sup>and black box <a href="https://www.youtube.com/watch?v=ksEmXuV324I">attacks</a>. The evolution of Backdoor.Win32.Skimer demonstrates the attacker interest in these malware families as ATMs are a very convenient cash-out mechanism for criminals. </p>
<p>One important detail to note about this case is the hardcoded information in the Track2 – the malware waits for this to be inserted into the ATM in order to activate. Banks may be able to proactively look for these card numbers inside their processing systems, and detect potentially infected ATMs, money mules, or block attempts to activate the malware.</p>
<p>We also recommend regular AV scans, the use of whitelisting technologies, a good device management policy, full disk encryption, the protection of ATM BIOS with a password, only allowing HDD booting, and isolating the ATM network from any other internal bank networks.</p>
<p>Kaspersky Lab has now identified 49 modifications of this malware, with 37 of these modifications targeting ATMs made by just one manufacturer. The most recent version was discovered at the beginning of May 2016.</p>
<p>All samples described are detected by Kaspersky Lab as Backdoor.Win32.Skimer. Patched SpiService.exe files are detected as Trojan.Win32.Patched.rb</p>
<p>As this is still an ongoing investigation, we have already shared the full report with different LEAs, CERTs, financial institutions and <a href="http://www.kaspersky.com/enterprise-security/intelligence-services">Kaspersky Lab Threat Intelligence-Service</a> customers. For more information please contact <a href="mailto:intelreports@kaspersky.com">intelreports@kaspersky.com</a></p>
<h2 id="appendix-i-indicators-of-compromise">Appendix I. Indicators of Compromise </h2>
<h3 id="hashes">Hashes</h3>
<p>F19B2E94DDFCC7BCEE9C2065EBEAA66C<br />3c434d7b73be228dfa4fb3f9367910d3<br />a67d3a0974f0941f1860cb81ebc4c37c<br />D0431E71EBE8A09F02BB858A0B9B80380<br />35484d750f13e763eae758a5f243133<br />e563e3113918a59745e98e2a425b4e81<br />a7441033925c390ddfc360b545750ff4</p>
<h3 id="filenames">Filenames</h3>
<p>C:\Windows\Temp\attrib1<br />C:\Windows\Temp\attrib4<br />C:\Windows\Temp\mk32<br />C:\Windows\Temp:attrib1<br />C:\Windows\Temp:attrib4<br />C:\Windows\Temp:mk32<br />C:\Windows\Temp:opt<br />C:\Windows\System32\netmgr.dll</p>
<h3 id="track-2-data">Track 2 data</h3>
<p>******446987512*=********************<br />******548965875*=********************<br />******487470138*=********************<br />******487470139*=********************<br />******000000000*=********************<br />******602207482*=********************<br />******518134828*=********************<br />******650680551*=********************<br />******466513969*=********************</p>
<p><a href="https://kas.pr/APT_reporting_SL_text_button" target="_blank"><img src="https://securelist.com/files/2015/11/640x60_apt_subscribe_banner.png" alt="Subscribe now For Kaspersky Lab's APT Intelligence Reports" width="640" height="60" class="aligncenter size-full wp-image-73094" /></a></p>
]]></content:encoded>
			<wfw:commentRss>http://securelist.com/blog/research/74772/atm-infector/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>The Rio Olympics: Scammers Already Competing</title>
		<link>http://securelist.com/blog/phishing/74754/the-rio-olympics-scammers-already-competing/</link>
		<comments>http://securelist.com/blog/phishing/74754/the-rio-olympics-scammers-already-competing/#respond</comments>
		<pubDate>Mon, 16 May 2016 10:56:24 +0000</pubDate>
		<dc:creator><![CDATA[Tatyana Shcherbakova]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[Phishing]]></category>
		<category><![CDATA[Malicious spam]]></category>
		<category><![CDATA[Scam]]></category>
		<category><![CDATA[Spam Letters]]></category>
		<category><![CDATA[Spammer techniques]]></category>
		<category><![CDATA[Tematic Spam]]></category>

		<guid isPermaLink="false">https://kasperskycontenthub.com/securelist/?p=74754</guid>
		<description><![CDATA[Back in 2015, a year before the Olympics in Rio, we registered fake notifications of lottery wins allegedly organized by the country's government and the International Olympic Committee. Similar emails continue to be sent in 2016. ]]></description>
				<content:encoded><![CDATA[<p><img width="400" height="280" src="http://securelist.com/wp-content/themes/securelist/images/article-default/abstraction_9.jpg" class="attachment-post-thumbnail wp-post-image no-image" alt="no-image"></p><p>A few years ago, spammers and scammers were not as interested in the Olympics as they were in football (the World Cup and European Championships). The first major increase in the number of spam messages devoted to the Olympic Games occurred in the run-up to the Winter Olympics in Sochi in 2014. Since then, their interest in the Olympics has shown no sign of weakening and the upcoming event in Brazil is no exception.</p>
<p>Back in 2015, a year before the Olympics in Rio, we registered fake notifications of lottery wins allegedly organized by the country&#8217;s government and the International Olympic Committee. Similar emails continue to be sent in 2016. The vast majority of these messages contain a DOC or PDF attachment, while the body of the message includes only a brief text asking the recipient to open the attachment.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_1.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_1.png" alt="The Rio Olympics: Scammers Already Competing" width="973" height="543" class="aligncenter size-full wp-image-74756" /></a></p>
<p>The name of the DOC file, the name of the sender and the subject line of the email often mention the Olympic Games.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_2.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_2.png" alt="The Rio Olympics: Scammers Already Competing" width="634" height="331" class="aligncenter size-full wp-image-74757" /></a></p>
<p>The content of these attachments is fairly standard: a lottery was held by an official organization; the recipient&#8217;s address was randomly selected from a large number of email addresses, and to claim their winnings the recipient has to respond to the email and provide the necessary personal information.</p>
<p>We also came across emails without attachments; the text written by the scammers was included in the body of the message.</p>
<p>English is undoubtedly the most popular language used in fraudulent emails exploiting the Olympics theme, but we have also registered messages in other languages, for example Portuguese. In these the spammers stuck to the same story of a lottery win, trying to convince the recipient that the email is genuine.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_3.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_3-1024x597.png" alt="The Rio Olympics: Scammers Already Competing" width="604" height="352" class="aligncenter size-large wp-image-74758" /></a></p>
<p>In addition to fraudulent spam, we have registered unsolicited advertising messages containing offers for various goods and services that, one way or another, use the Olympics to grab the attention of recipients.</p>
<p>For example, spammers have been pushing new TVs for watching sporting events.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_4.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_4.png" alt="The Rio Olympics: Scammers Already Competing" width="916" height="401" class="aligncenter size-full wp-image-74759" /></a></p>
<p>They also promised to make the recipient an &#8220;Olympic champion&#8221; with the help of magic pills.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_5.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_5-1024x463.png" alt="The Rio Olympics: Scammers Already Competing" width="604" height="273" class="aligncenter size-large wp-image-74760" /></a></p>
<p>Taking any of these emails seriously enough to reply to them could well leave you out of pocket. But the biggest hit that sporting fans&#8217; wallets are likely to take are from fake ticketing services. We are constantly blocking dozens of newly registered domains with names containing the words &#8220;rio&#8221;, &#8220;rio2016&#8221; and so on. Each of these domains hosted good quality imitations of official services offering tickets to sporting events at this summer&#8217;s games in Rio de Janeiro. </p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_6.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_6-1024x519.png" alt="The Rio Olympics: Scammers Already Competing" width="604" height="306" class="aligncenter size-large wp-image-74761" /></a></p>
<p>The scammers register these domains to make their sites look more credible; for the same purpose, they often buy the cheapest and simplest SSL certificates. These certificates are registered within a few minutes, and certification authorities don&#8217;t verify the legal existence of the organization that has issued the certificate. The certificates simply provide data transfer over a secure protocol for the domain and, most importantly, gives fraudsters the desired &#8220;https&#8221; at the beginning of their address.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_7.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_7-1024x594.png" alt="The Rio Olympics: Scammers Already Competing" width="604" height="350" class="aligncenter size-large wp-image-74762" /></a></p>
<p>If you examine the whois data for such domains, you will find that they have only been registered recently, for a short period of time (usually a year) and in the names of individuals. Moreover, the detailed information is often hidden, and the hosting provider could be located anywhere, from Latin America to Russia.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_8.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_8-1024x627.png" alt="The Rio Olympics: Scammers Already Competing" width="604" height="370" class="aligncenter size-large wp-image-74763" /></a></p>
<p>The sites are necessary to implement a simple scam whereby the phishers ask for bank card information, allegedly to pay for tickets, and then use it to steal money from the victim&#8217;s bank account. In order to keep the buyer in the dark for some time, the scammers assure them that the payment has been received for the tickets and that they will be sent out two or three weeks before the event.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_9.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_9-1024x405.png" alt="The Rio Olympics: Scammers Already Competing" width="604" height="239" class="aligncenter size-large wp-image-74764" /></a></p>
<p>As a result, the criminals not only steal the victim&#8217;s money but deprive them of the chance of attending the Olympics – by the time they realize they won&#8217;t be getting the tickets they booked it will be too late to buy genuine tickets&#8230; especially if there&#8217;s no money in their bank account.</p>
<p>According to our information, the creation of these fake sites usually involves international cybercriminal groups, each fulfilling its own part of the scam. One group creates a website, the second registers the domains, the third collects people&#8217;s personal information and sells it, and the fourth withdraws the cash.</p>
<p>To avoid falling victim to the scammers&#8217; tricks, sports fans should be careful and only buy tickets from authorized reseller sites and ignore resources offering tickets at very low prices. The <a href="https://www.rio2016.com/en">official website of the Olympic Games</a> provides a list of official ticket sellers in your region and a service that allows you to check the legitimacy of sites selling tickets.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_10.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/rio_olympics_en_10-1024x728.png" alt="The Rio Olympics: Scammers Already Competing" width="604" height="429" class="aligncenter size-large wp-image-74765" /></a></p>
<p>Also, we strongly recommend not buying anything in stores advertised in spam mailings or advertising banners, whether it&#8217;s tickets or souvenirs related to the Olympics. At best, you&#8217;ll end up with non-certified goods of dubious quality, and at worst – you&#8217;ll just be wasting your money. For those who cannot resist impulse purchases, we recommend getting a separate bank card that is only used for online payments and which only ever has small sums of money on it. This will help to avoid serious losses if your banking information is stolen.</p>
]]></content:encoded>
			<wfw:commentRss>http://securelist.com/blog/phishing/74754/the-rio-olympics-scammers-already-competing/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Spam and phishing in Q1 2016</title>
		<link>http://securelist.com/analysis/quarterly-spam-reports/74682/spam-and-phishing-in-q1-2016/</link>
		<comments>http://securelist.com/analysis/quarterly-spam-reports/74682/spam-and-phishing-in-q1-2016/#respond</comments>
		<pubDate>Thu, 12 May 2016 10:56:14 +0000</pubDate>
		<dc:creator><![CDATA[Darya Gudkova]]></dc:creator>
				<category><![CDATA[Analysis]]></category>
		<category><![CDATA[Featured]]></category>
		<category><![CDATA[Quarterly Spam Reports]]></category>
		<category><![CDATA[Malicious spam]]></category>
		<category><![CDATA[Malware Descriptions]]></category>
		<category><![CDATA[Nigerian Spam]]></category>
		<category><![CDATA[Phishing]]></category>
		<category><![CDATA[Social Engineering]]></category>
		<category><![CDATA[Spam]]></category>
		<category><![CDATA[Spam Statistics]]></category>
		<category><![CDATA[Spammer techniques]]></category>
		<category><![CDATA[Tematic Spam]]></category>

		<guid isPermaLink="false">https://kasperskycontenthub.com/securelist/?p=74682</guid>
		<description><![CDATA[In the first quarter of 2016 the percentage of spam in email traffic increased by 2.7 percentage points compared with the previous quarter. But it is too early to speak about a growth trend. The US remained the biggest source of spam in Q1 2016. The Top 5 also included Vietnam, India, Brazil and China – all large, fast developing countries with high levels of internet connection.]]></description>
				<content:encoded><![CDATA[<p><img width="500" height="332" src="http://securelist.com/files/2014/08/quarter_spam.jpg" class="attachment-securelist-huge-promo size-securelist-huge-promo wp-post-image" alt="quarter_spam" /></p><h2 id="spam-features-of-the-quarter">Spam: features of the quarter</h2>
<h3 id="trending-dramatic-increase-in-volume-of-malicious-spam">Trending: dramatic increase in volume of malicious spam</h3>
<p>The first quarter of 2016 saw a dramatic increase in the number of unsolicited emails containing malicious attachments. Over the last two years the number of email antivirus detections on computers with a Kaspersky Lab product installed fluctuated between 3 and 6 million. At the end of 2015 this number began to grow and in early 2016 there was a sharp upturn. </p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_1.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_1-1024x451.png" alt="Spam and phishing in Q1 2016" width="604" height="266" class="aligncenter size-large wp-image-74686" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Number of email antivirus detections on computers with a Kaspersky Lab product installed</em></p>
<p>In March, the number of email antivirus detections reached 22,890,956, which is four times more than the average for the same period last year.</p>
<p>With the rise of drive-by-downloads, we could have expected malicious email attachments to have long since given way to malicious sites that the user accesses via a link in an email. However, the use of emails has its advantages (for the attackers): the content of the email may encourage the user not only to download a malicious file but also launch it. It&#8217;s also possible that malicious attachments are enjoying a new wave of popularity because in the last couple of years the developers of the most popular browsers have considered adding protection against infected and phishing websites (using in-house developments as well as partnering with well-known anti-virus vendors). This is something that built-in protection at the email client level does not provide yet. Therefore, if a potential victim doesn&#8217;t use antivirus software, their computer can be easily infected via email. </p>
<h4 id="whats-inside">What&#8217;s inside?</h4>
<p>The variety of malicious attachments is impressive. They include classic executable EXE files and office documents (DOC, DOCX, XLS, RTF) with embedded malicious macros, and programs written in Java and Javascript (JS files, JAR, WSF, WRN, and others).</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_2.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_2.png" alt="Spam and phishing in Q1 2016" width="457" height="254" class="aligncenter size-full wp-image-74687" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Attachment containing a Trojan downloader written in Java</em></p>
<p>Also worth noting is the diversity of languages used in malicious spam. In addition to English, we regularly came across emails in Russian, Polish, German, French, Spanish, Portuguese and several other languages.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_3.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_3.png" alt="Spam and phishing in Q1 2016" width="452" height="249" class="aligncenter size-full wp-image-74688" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Attachment containing the Trojan banker Gozi</em></p>
<p>Most emails imitated notifications of unpaid bills, or business correspondence.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_4.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_4.png" alt="Spam and phishing in Q1 2016" width="575" height="294" class="aligncenter size-full wp-image-74689" /></a></p>
<p style="text-align:center;font-weight:bold"><em>The malicious .doc file in the attachment is a Trojan downloader. It downloads and runs the encryptor Cryakl using macros written in Visual Basic</em></p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_5.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_5.png" alt="Spam and phishing in Q1 2016" width="602" height="606" class="aligncenter size-full wp-image-74690" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Attachment containing backdoor-type malware that downloads other malicious programs to the infected machine</em></p>
<p>Particular attention should be paid to emails containing Trojan downloaders that download the <a href="https://securelist.com/blog/research/74398/locky-the-encryptor-taking-the-world-by-storm/">Locky</a> encryptor. The attackers exploited a variety of file types to infect victim computers: at first they used .doc files with malicious macros, then JS scripts. In order to bypass filtering, the attackers made every malicious file within a single mass mailing unique. In addition, the emails had different content and were written in different languages. This doesn&#8217;t come as much of a surprise as attacks utilizing this encryptor were registered by <a href="http://www.kaspersky.com/images/KESB_Whitepaper_KSN_ENG_final.pdf">KSN</a> in 114 countries around the world.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_6.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_6-1024x493.png" alt="Spam and phishing in Q1 2016" width="604" height="291" class="aligncenter size-large wp-image-74691" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Examples of emails with the Locky encryptor</em></p>
<p>The content of the emails was related to financial documents and prompted users to open the attachment. </p>
<p>If the attack was successful, Locky encrypted files with specific extensions (office documents, multimedia content, etc.) on the user&#8217;s computer, and displayed a message with a link leading to a site on the Tor network containing the cybercriminals&#8217; demands. This process was analyzed in more detail in our <a href="https://securelist.com/blog/research/74398/locky-the-encryptor-taking-the-world-by-storm/">blog</a>.</p>
<p>As Locky is not always contained directly in the message, we cannot estimate its share in the volume of other malicious mail. However, the scripts that download and run Locky (detected by Kaspersky Lab as Trojan-Downloader.MSWord.Agent, Trojan-Downloader.JS.Agent, HEUR: Trojan-Downloader.Script.Generic) accounted for more than 50% of all malicious programs in email traffic. </p>
<h3 id="spam-terrorism">Spam terrorism</h3>
<p>Today terrorism is one of the most widely discussed topics both in the media and when political leaders meet. Frequent terrorist attacks in Europe and Asia have become a major threat to the world community, and the theme of terrorism is widely used by cybercriminals to mislead users. </p>
<p>In order to prevent terrorist attacks, security measures in many countries have been enhanced, and malicious spammers have been quick to take advantage. They tried to convince recipients of mass mailings that a file attached in an email contained information that would help a mobile phone owner detect an explosive device moments before it was about to detonate. The email claimed the technology came from the US Department of Defense, was easy to use and widely available. The attachment, in the form of an executable EXE file, was detected as Trojan-Dropper.Win32.Dapato – a Trojan that is used to steal personal information, organize DDoS attacks, install other malware, etc. </p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_7.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_7-1024x334.png" alt="Spam and phishing in Q1 2016" width="604" height="197" class="aligncenter size-large wp-image-74692" /></a></p>
<p>&#8216;Nigerian&#8217; scammers also got in on the act, exploiting the theme of terrorism to try and concoct credible stories. The senders introduced themselves as employees of a non-existent FBI division involved in the investigation of terrorism and financial crime. Their story revolved around the need for the recipient to contact the sender in order to resolve issues that are preventing the payment of a large sum of money. Among the reasons given for the delay in transferring the money the scammers cited a lack of confirmation that the money was legal and rightfully belonged to the recipient, or it was claimed third parties were trying to pocket the recipient&#8217;s money.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_8.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_8-1024x679.png" alt="Spam and phishing in Q1 2016" width="604" height="401" class="aligncenter size-large wp-image-74693" /></a></p>
<p>Nigerian letters also told stories of money – some of which was offered to the recipient – that had been obtained legally and was not related to drugs, terrorism or other crime. This was an attempt to dispel any doubts about their honesty and persuade recipients to reply.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_9.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_9-1024x331.png" alt="Spam and phishing in Q1 2016" width="604" height="195" class="aligncenter size-large wp-image-74694" /></a></p>
<p>The theme of terrorism came up again in tales related to the current situation in the Middle East. For example, some emails were sent on behalf of US soldiers who were fighting against terrorism in Afghanistan and were looking for an intermediary to save and invest money for them. Yet another author claimed that he had not joined ISIS or any another terrorist organization, but as a Muslim he wanted to donate a large sum of money for good deeds. A mistrust of charities meant the &#8220;Muslim&#8221; wanted to transfer the money to the recipient of the email. Yet another story was written on behalf of an American businessman who had lost half his business in Syria and Iraq because of the war and terrorism, and was looking for a partner to help him invest the remaining money.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_10.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_10-1024x739.png" alt="Spam and phishing in Q1 2016" width="604" height="436" class="aligncenter size-large wp-image-74695" /></a></p>
<p>Nigerian letters describing the tense situation in Syria also remained popular and were actively used by scammers to trick users.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_11.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_11-1024x281.png" alt="Spam and phishing in Q1 2016" width="604" height="166" class="aligncenter size-large wp-image-74696" /></a></p>
<p> We also came across advertising spam from Chinese factories offering all sorts of devices to ensure public security (for example, special devices for detecting explosives) and other anti-terrorist products.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_12.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_12.png" alt="Spam and phishing in Q1 2016" width="976" height="616" class="aligncenter size-full wp-image-74697" /></a></p>
<h3 id="also-trending-significant-increase-in-volume-of-nigerian-spam">Also trending: significant increase in volume of &#8216;Nigerian&#8217; spam</h3>
<p>It seems so-called Nigerian spammers have also felt the effects of the economic crisis, because they have recently increased their activity. In Q1 2016 we observed a significant increase in the volume of this type of mailing. In the past, the scammers encouraged recipients to respond to an email by telling a long detailed story that often contained links to articles in the mainstream media; now they send out short messages with no details, just a request to get in touch. Sometimes the email may mention a large sum of money that will be discussed in further correspondence, but there is no information about where it came from.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_13.jpg" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_13.jpg" alt="Spam and phishing in Q1 2016" width="840" height="852" class="aligncenter size-full wp-image-74698" /></a></p>
<p>Perhaps the scammers believe that those who are already aware of the classic &#8216;Nigerian&#8217; tricks will fall for these types of messages; or maybe they think that such short messages will be more suited for busy people who have no time to read long emails from strangers.</p>
<h3 id="spammer-methods-and-tricks-short-url-services-and-obfuscation">Spammer methods and tricks: short URL services and obfuscation</h3>
<p>In our spam and phishing <a href="https://securelist.com/analysis/kaspersky-security-bulletin/73591/kaspersky-security-bulletin-spam-and-phishing-in-2015/">report</a> for 2015 we wrote about obfuscation of domains. In Q1 2016, spammers continued this trend and even added some new tricks to their arsenal.</p>
<p>Cybercriminals continued to use short URL services, although the methods for adding &#8220;noise&#8221; to them have changed.</p>
<p>First of all, spammers began inserting characters – slashes, letters and dots – between the domain of a short URL service and the final link.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_14.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_14.png" alt="Spam and phishing in Q1 2016" width="659" height="847" class="aligncenter size-full wp-image-74699" /></a></p>
<p>Both the link which the user follows and the link to the uploaded image in the email are obfuscated: </p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_15.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_15.png" alt="Spam and phishing in Q1 2016" width="646" height="150" class="aligncenter size-full wp-image-74700" /></a></p>
<p>In addition to letters and dots, spammers even inserted random comment tags between slashes, and the browser continued to correctly interpret the links:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_16.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_16.png" alt="Spam and phishing in Q1 2016" width="699" height="853" class="aligncenter size-full wp-image-74701" /></a></p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_17.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_17.png" alt="spam_q1_2016_eng_17" width="638" height="207" class="aligncenter size-full wp-image-74702" /></a></p>
<p>Note that the subject of the email contains the name Edward; it is also included in the comment tag used to add &#8220;noise&#8221;. In other words, the name is taken from one database while the &#8220;noise&#8221; tag is unique for each email in the mass mailing.</p>
<p>Russian-language spam also used obfuscation and short URL services, but the algorithm was different.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_18.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_18.png" alt="spam_q1_2016_eng_18" width="524" height="390" class="aligncenter size-full wp-image-74703" /></a></p>
<p>For example, to obfuscate links the @ symbol was used. To recap, the @ symbol is intended for user authentication on the site (it is actually no longer used). If the site does not require authentication, everything that precedes the @ symbol will simply be ignored. It means that in the email above, the browser will first open the site ask.ru/go where it will execute the subquery &#8216;url =&#8217; and then go to the URL specified, which belongs to a short URL service.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_19.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_19.png" alt="spam_q1_2016_eng_19" width="604" height="324" class="aligncenter size-full wp-image-74704" /></a></p>
<p>The link in this emails was also obfuscated with the @ symbol. Noise was also added by additional subqueries including the user&#8217;s email address, which made it unique for each email in the mass mailing.</p>
<h2 id="statistics">Statistics</h2>
<h3 id="proportion-of-spam-in-email-traffic">Proportion of spam in email traffic</h3>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_20.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_20-1024x533.png" alt="Spam and phishing in Q1 2016" width="604" height="314" class="aligncenter size-large wp-image-74705" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Percentage of spam in global email traffic, Q1 2016</em></p>
<p>The percentage of spam in overall global email traffic remained stable during the last few months of 2015. However, in January 2016 we registered a considerable increase in the share of unwanted correspondence – over 5.5 p.p. By February, however, the amount of spam in email traffic had dropped to its previous level. In March it grew again, though less dramatically. As a result, the average percentage of spam in Q1 2016 amounted to 56.92%.</p>
<h3 id="sources-of-spam-by-country">Sources of spam by country</h3>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_21.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_21-1024x780.png" alt="Spam and phishing in Q1 2016" width="604" height="460" class="aligncenter size-large wp-image-74706" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Sources of spam by country, Q1 2016</em></p>
<p>The US (12.43%) maintained its leadership, remaining the biggest source of spam in Q1 2016. Next came Vietnam (10.30%), India (6.19%) and Brazil (5.48%). China rounded off the Top 5, accounting for 5.09% of global spam.</p>
<p>Russia fell from last year&#8217;s second place to seventh (4.89%) in Q1 2016. It followed closely behind France (4.90%), which was sixth biggest source of spam.</p>
<h3 id="spam-email-size">Spam email size</h3>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_22.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_22.png" alt="Spam and phishing in Q1 2016" width="1017" height="631" class="aligncenter size-full wp-image-74707" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Spam email size distribution, Q4 2015 and Q1 2016</em></p>
<p>The most commonly distributed emails were very small – up to 2 KB (79.05%). The proportion of these emails grew by 2.7 p.p. from the previous quarter. The share of emails sized 20-50 KB also increased – from 3.02% to 7.67%. The amount of emails sized 2-5 KB, however, fell significantly compared to Q4 2015 – from 8.91% to 2.5%. </p>
<h2 id="malicious-email-attachments">Malicious email attachments</h2>
<p>Currently, the majority of malicious programs are detected proactively by automatic means, which makes it very difficult to gather statistics on specific malware modifications. So we have decided to turn to the more informative statistics of the Top 10 malware families.</p>
<h3 id="top-10-malware-families">Top 10 malware families</h3>
<ol>
<li>Trojan-Downloader.JS.Agent.</li>
<p>A typical representative of this family is an obfuscated Java script. This family malware uses ADODB.Stream technology that allows them to download and run DLL, EXE and PDF files.</p>
<li>Trojan-Downloader.VBS.Agent.</li>
<p>This is a family of VBS scripts. As is the case with the JS.Agent family, ranked first, the representatives of this family use ADODB.Stream technology; however, they mainly download ZIP files, from which they extract and run other malicious software.</p>
<li>Trojan-Downloader.MSWord.Agent.</li>
<p>The representatives of this family are DOC files with an embedded macro written in Visual Basic for Applications (VBA) that runs when the document is opened. The macro downloads other malware from the cybercriminal&#8217;s site and launches it on the victim&#8217;s computer. </p>
<li>Backdoor.Win32.Androm. Andromeda.</li>
<p>This is a family of universal Andromeda/Gamarue modular bots. The key features of these bots include downloading, storing and launching malicious executable files; downloading and uploading a malicious DLL (without saving it to disk); updating and deleting themselves. The bot functionality is extended with plug-ins that can be loaded at any time.</p>
<li>Trojan.Win32.Bayrob.</li>
<p>The malicious programs of this Trojan family can download from the command server and run additional modules, as well as work as a proxy server. They are used to distribute spam and steal personal data.</p>
<li>Trojan-Downloader.JS.Cryptoload.</li>
<p>A typical representative of this family is an obfuscated Java script. The malicious programs of this family download and run ransomware on the user&#8217;s computer.</p>
<li>Trojan-PSW.Win32.Fareit.</li>
<p>This malware family was designed to steal data such as credentials for FTP clients installed on an infected computer, credentials for cloud storage programs, cookie files in browsers, passwords for email accounts. The stolen information is sent to the criminals&#8217; server. Some members of the Trojan Fareit family are capable of downloading and running other malware.</p>
<li>Trojan.Win32.Agent. </li>
<p>The malicious programs of this family destroy, block, modify or copy data or disrupt the operation of computers or computer networks.</p>
<li>Trojan-Downloader.Win32.Upatre.</li>
<p>The Trojans of this family do not exceed 3.5 KB, and their functions are limited to downloading payloads on the infected computer – more often than not these are Trojan bankers known as Dyre/Dyzap/Dyreza. The main aim of this family of Trojan bankers is to steal payment data from users.</p>
<li>Trojan-Spy.HTML.Fraud.</li>
<p>The Trojans of this family consist of a fake HTML page sent via email that imitates an important notification from a major commercial bank, online store, or software developer, etc. The user has to enter their personal data on this page, which is then forwarded to cybercriminals.</p>
</ol>
<h3 id="countries-targeted-by-malicious-mailshots">Countries targeted by malicious mailshots</h3>
<p>There were some significant changes in the ranking of countries targeted most often by mailshots in Q1 2016.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_23.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_23-1024x767.png" alt="Spam and phishing in Q1 2016" width="604" height="452" class="aligncenter size-large wp-image-74708" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of email antivirus verdicts by country, Q1 2016</em></p>
<p>Germany (18.93%) remained on top. China (9.43%), which ended 2015 in 14th place, unexpectedly came second. Brazil (7.35%) rounded off the Top 3.</p>
<p>Italy (6.65%) came fourth in the ranking, followed by the UK (4.81%). Russia was in sixth place with a share of 4.47%.</p>
<p>The US (3.95%), which had been in the Top 5 countries targeted by malicious mailshots for months on end, ended Q1 in eighth. </p>
<h2 id="phishing">Phishing</h2>
<p>In Q1 2016, the Anti-Phishing system was triggered 34,983,315 times on the computers of Kaspersky Lab users.</p>
<h3 id="geography-of-attacks">Geography of attacks</h3>
<p>The country where the largest percentage of users were affected by phishing attacks was once again Brazil (21.5%), with a 3.37 p.p. increase from the previous quarter. The share of those attacked in China (16.7%) and the UK (14.6%) also grew compared to Q4 2015 – by 4.4 p.p. and 3.68 p.p. respectively. Japan (13.8%), which was a leader in the previous year, saw its share fall by 3.18 p.p.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_24.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_24.png" alt="Spam and phishing in Q1 2016" width="890" height="526" class="aligncenter size-full wp-image-74709" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Geography of phishing attacks*, Q1 2016</em></p>
<p><small><i>* Number of users on whose computers the Anti-Phishing system was triggered as a percentage of the total number of Kaspersky Lab users in the country</i></small></p>
<p><b>Top 10 countries by percentage of users attacked:</b></p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Brazil</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 1px solid #BCD9DD;text-align:center">21.5%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">China</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">16.7%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">United Kingdom</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">14.6%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Japan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">13.8%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">India</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">13.1%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Australia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">12.9%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Bangladesh</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">12.4%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Canada</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">12.4%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Ecuador</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">12.2%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Ireland</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">12.0%</td>
</tr>
</table>
</div>
<h3 id="organizations-under-attack">Organizations under attack</h3>
<p><i>The statistics on phishing targets are based on detections of Kaspersky Lab&#8217;s anti-phishing component. It is activated every time a user enters a phishing page when information about it is not yet included in Kaspersky Lab databases. It does not matter how the user enters the page – by clicking a link in a phishing email, in a message on a social network or as a result of malware activity. After the security system is activated, the user sees a banner in the browser warning about a potential threat.</i></p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_25.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_25-1024x682.png" alt="Spam and phishing in Q1 2016" width="604" height="402" class="aligncenter size-large wp-image-74710" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of organizations affected by phishing attacks, by category, Q1 2016</em></p>
<p>In the first quarter of 2016, the &#8216;Global Internet portals&#8217; category (28.69%) topped the rating of organizations attacked by phishers; its share increased by 0.39 p.p. from the previous quarter. Second and third were occupied by two financial categories: &#8216;Banks&#8217; (+4.81 p.p.) and &#8216;Payment systems&#8217; (-0.33 p.p.). &#8216;Social networking sites&#8217; (11.84%) and &#8216;Online games&#8217; (840 p.p.) rounded off the Top 5, having lost 0.33p.p.and 4.06 p.p. respectively.</p>
<h4 id="online-stores">Online stores</h4>
<p>Attacks on online store users are interesting because they are often followed by the theft of bank card details and other personal information.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_26.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_26-1024x680.png" alt="Spam and phishing in Q1 2016" width="604" height="401" class="aligncenter size-large wp-image-74711" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of online stores subject to phishing attacks, Q1 2016</em></p>
<p>Apple Store was the most popular online store with phishers. In the first quarter of 2016 its share in the &#8216;E-shop&#8217; category accounted for 27.82%. Behind it in second place was another popular online store –Amazon (21.6%).</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_27.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_27-1024x889.png" alt="Spam and phishing in Q1 2016" width="604" height="524" class="aligncenter size-large wp-image-74712" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Example of a phishing page designed to steal Apple ID and bank card data</em></p>
<p>Steam (13.23%), a popular gaming service that distributes computer games and programs, rounded off the Top 3. It came 19th in the overall ranking of organizations affected by phishing attacks.</p>
<p>Links to phishing pages exploiting the theme of online games and gaming services are distributed via banners, posts on social networking sites, forums and, less frequently, via email.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_28.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_28-1024x618.png" alt="Spam and phishing in Q1 2016" width="604" height="365" class="aligncenter size-large wp-image-74713" /></a></p>
<p>Cybercriminal interest in Steam and gaming services in general is growing – gamers&#8217; money and personal data are often targeted not only by phishers but also by <a href="https://securelist.com/blog/research/74137/all-your-creds-are-belong-to-us/">software developers</a>. </p>
<h4 id="top-3-organizations-attacked">Top 3 organizations attacked&lt;</h4>
<p>Fraudsters continue to focus the greatest part of their non-spear phishing attacks on the most popular companies. These companies have lots of customers around the world which enhances the chances of a successful phishing attack. </p>
<p>The Top 3 organizations attacked most often by phishers accounted for 21.71% of all phishing links detected in Q1 2016.</p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Organization</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">% of detected phishing links</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Yahoo!</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8.51</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Microsoft </td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7.49</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Facebook</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5.71</td>
</tr>
</table>
</div>
<p>In Q1 2016, the leading three organizations targeted by phishers saw a few changes. Yahoo! remained top (+1.45 p.p.). Microsoft (+2.47 p.p.) came second, followed by Facebook (-2.02 p.p.).</p>
<p>Interestingly, phishing on Facebook is delivered in almost all languages.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_29.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_29.png" alt="Spam and phishing in Q1 2016" width="882" height="682" class="aligncenter size-full wp-image-74714" /></a></p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_30.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/spam_q1_2016_eng_30-1024x890.png" alt="Spam and phishing in Q1 2016" width="604" height="525" class="aligncenter size-large wp-image-74715" /></a></p>
<p>Facebook is also popular with cybercriminals as a means of spreading malicious content. We wrote about one such scheme in a recent <a href="https://blog.kaspersky.com/facebook-video-scam/11829/">blog</a>. </p>
<h2 id="conclusion">Conclusion</h2>
<p>In the first quarter of 2016 the percentage of spam in email traffic increased by 2.7 percentage points compared with the previous quarter. But it is too early to speak about a growth trend. The proportion of spam grows significantly at the beginning of every year because the amount of normal email decreases over the holiday period.</p>
<p>The US remained the biggest source of spam in Q1 2016. The Top 5 also included Vietnam, India, Brazil and China – all large, fast developing countries with high levels of internet connection.</p>
<p>Spam messages are becoming shorter. In the first quarter, the proportion of emails up to 2 KB exceeded 80% of all spam.</p>
<p>Q1 of 2016 saw the amount of spam containing malicious attachments increase dramatically. The share of malicious attachments in mail reached a peak in March – four times greater than last year&#8217;s average. This rapid growth was caused, specifically by the popularity of crypto-ransomware which was either contained in emails or downloaded to computers via a Trojan downloader.</p>
<p>This growth confirms our long-term forecasts on the gradual criminalization of spam that makes it even more dangerous, as well as reducing the overall share of email traffic. The diversity of languages, social engineering, lots of different types of attachments, text changing within a single mass mailing – all this takes spam to a new level of danger. Moreover, these malicious mass mailings have broad geographical coverage. The picture of malware distribution by email has changed significantly this year. In particular, China came an unexpected second in the ranking of countries targeted by malicious mailshots.</p>
<p>Another factor confirming the trend of increasingly criminalized spam is the growth of fraudulent, namely &#8216;Nigerian&#8217;, spam in the first quarter of 2016.</p>
<p>It is unlikely that the amount of malicious spam will continue to grow so rapidly: the more cybercriminals distribute malicious spam, the more people get to know of its dangers and the more careful they become about opening suspicious attachments. Therefore, such attacks will gradually fade away after a few months. However, there is the risk they may be replaced by other, even more complex attacks.</p>
]]></content:encoded>
			<wfw:commentRss>http://securelist.com/analysis/quarterly-spam-reports/74682/spam-and-phishing-in-q1-2016/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Results of PoC Publishing</title>
		<link>http://securelist.com/blog/research/74724/results-of-poc-publishing/</link>
		<comments>http://securelist.com/blog/research/74724/results-of-poc-publishing/#respond</comments>
		<pubDate>Wed, 11 May 2016 11:01:19 +0000</pubDate>
		<dc:creator><![CDATA[Victor Chebyshev]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[Research]]></category>
		<category><![CDATA[Mobile Malware]]></category>
		<category><![CDATA[Vulnerabilities and exploits]]></category>

		<guid isPermaLink="false">https://kasperskycontenthub.com/securelist/?p=74724</guid>
		<description><![CDATA[Malware writers have learnt to upload malware apps onto Android devices of unsuspecting users by using JavaScript. Publically available remote-code-execution vulnerability use cases written by antivirus software experts were used as a handy manual by malware writers.]]></description>
				<content:encoded><![CDATA[<p><img width="400" height="280" src="http://securelist.com/wp-content/themes/securelist/images/article-default/abstraction_1.jpg" class="attachment-post-thumbnail wp-post-image no-image" alt="no-image"></p><h2 id="dreams-of-a-threat-actor">Dreams of a Threat Actor</h2>
<p>There are two crucial features of the Android OS protection system:</p>
<ol>
<li>it is impossible to download a file without user&#8217;s knowledge on a clean device;</li>
<li>it is impossible to initialize installation of a third-party app without user&#8217;s knowledge on a clean device.</li>
</ol>
<p>These approaches greatly complicate malware writers&#8217; lives: to infect a mobile device, they have to resort to ruses of social engineering. The victim is literally tricked into force-installing a Trojan. This is definitely not always possible, as users become more aware, and it is not that easy to trick them.</p>
<p>Invisible installation of a malware app onto a mobile device without a user&#8217;s knowledge is definitely a daydream of many a malware writer. To do that, it is necessary to find and exploit an Android system vulnerability. These vulnerabilities have been found: we are talking about <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-6636">CVE-2012-6636</a>, <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-4710">CVE-2013-4710</a>, and <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1939">CVE-2014-1939</a>.</p>
<p>These vulnerabilities allow to execute any code on a device by means of a custom-made HTML page with a JavaScript code. The vulnerabilities have been closed, starting with Android 4.1.2.</p>
<p>It would be great to say that everything is fine now, but, alas, that is not so. We should not forget about the third feature of the Android OS: a device manufacturer is responsible for creating and deploying updates for its specific device model. </p>
<p>Updating the Android operating system is decentralized: each company uses its own custom version of Android, compiled with its own compilers and supplied with its own optimization and drivers. Regardless of who has found a vulnerability and whether that person has informed the OS developer about it, releasing updates is a prerogative of each manufacturer. Only manufacturers are capable of helping the users.</p>
<p>Nevertheless, updates are released somewhat periodically but mostly for the leading models: not all of the manufacturers actively support all of their models.</p>
<p>A publically available detailed description of vulnerabilities for the Android OS provides malware writers with all of the required knowledge. Incidentally, a potential victim of the vulnerability exploits can remain such for a long period of time: let us call it &#8220;an endless 0-day&#8221;. The problem can be solved only by buying a new device. </p>
<p>This, in particular, coupled with publically available descriptions of the vulnerabilities and examples of the vulnerabilities being exploited, incited malware writers into developing an exploit and performing drive-by attacks onto mobile devices.</p>
<h2 id="web-site-infection">Web Site Infection</h2>
<p>Drive-by attacks on computers of unsuspecting users give a large audience to threat actors (if they manage to post a malicious code on popular web sites) as well as invisibility (inasmuch as users do not suspect being infected). Owners of compromised web sites may not suspect being infected for a long time as well.</p>
<p>The method of code placement and other attack features allow one to distinguish web sites infected with the same &#8220;infection&#8221;. For quite long, we observed a typical infection within a group of minimum several dozens of Russian web sites of different types and attendances, including quite well-known and popular resources (for example, web sites with a daily turn-out of 25,000 and 115,000 users). Web-site infection from this group is characterized by the usage of the same intermediate domains, the similarity of the malicious code placed onto them, the method of code placement (in most cases, it is placed on the same domain as an individual JavaScript file), as well as speed and synchronicity of changes in the code on all of the infected web sites after the malicious code has been detected.</p>
<p>The attack method has been standard (even though it has gone through some changes), and it has been used at least since 2014. It has been standard also owing to its targeting Windows OS users. However, some time ago, after threat actors performed a regular modification of the code on infected web sites, we discovered a new script instead of a &#8220;common&#8221; one that uploads flash exploits. It checked for the &#8220;Android 4&#8221; setting in User-Agent and operated with tools uncommon for Windows. This anomaly urged us to study the functionality of the script meticulously and watch the infection more closely.</p>
<p>Thus, on the 22nd of January 2016, we discovered a JavaScript code that exploited an Android vulnerability. Only within 3 days, on the 25th of January 2016, we found a new modification of this script with more threatening features.</p>
<h2 id="scripts">Scripts</h2>
<p>We managed to detect two main script modifications.</p>
<h3 id="script-1-sending-sms">Script 1: Sending SMS</h3>
<p>The only goal of the first script is to send an SMS message to a phone number of threat actors with the word &#8220;test&#8221;. For that, the malware writers took advantage of the Android Debug Bridge (ADB) client that exists on all of the devices. The script executes a command to check for the ADB version on a device using the Android Debug Bridge Daemon (ADBD). The result of the command execution is sent to the server of the threat actors.</p>
<p>The code for sending an SMS is commented. In fact, it cannot be executed. However, if it is uncommented, then devices with the Android version below 4.2.2 could execute the commands given by malware writers. For newer versions of Android, the ADBD local connection (in the Loopback mode) is forbidden on the device.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_1.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_1-1024x89.png" alt="Results of PoC Publishing" width="604" height="52" class="aligncenter size-large wp-image-74727" /></a></p>
<p>Sending an SMS to a regular number does not promise big losses for the victim, but nothing prevents the malware writers from replacing the test number with a premium-rate number. </p>
<p>The first malicious script modification should not cause any big problems for users, even if the threat actors would be able to send an SMS to a short code. Most mobile carriers have the Advice-of-Charge feature, which does not apply any charges for the first SMS to a premium-rate number: one more message with a specific text must be sent. This is impossible to do from within a JavaScript code for the specific case. This is why, most likely, a second modification of the script has appeared.</p>
<h3 id="script-2-sd-card-file">Script 2: SD-Card File</h3>
<p>The second script, in effect, is a dropper. It drops a malicious file from itself onto an SD card.</p>
<p>By resorting to unsophisticated instructions, part of the script body is decrypted. First of all, separators are removed from the string: </p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_2.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_2.png" alt="Results of PoC Publishing" width="491" height="200" class="aligncenter size-full wp-image-74728" /></a></p>
<p>Then, the string is recorded onto an SD card into the MNAS.APK file:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_3.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_3.png" alt="Results of PoC Publishing" width="908" height="21" class="aligncenter size-full wp-image-74729" /></a></p>
<p>The string must be executed. As a result, the created app should be installed onto the system: </p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_4.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_4.png" alt="Results of PoC Publishing" width="658" height="189" class="aligncenter size-full wp-image-74730" /></a></p>
<p>However, this code is yet still commented.</p>
<p>Let us review the script in more detail. The script has a check for a specific Android version (it has to be 4).</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_5.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_5.png" alt="Results of PoC Publishing" width="386" height="78" class="aligncenter size-full wp-image-74731" /></a></p>
<p>Obviously, the malware writers know which versions are vulnerable, and they are not trying to run the script on Android 5 or 6.</p>
<p>Just like with the first script, the second has an ADB check at the control center side:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_6.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_6.png" alt="Results of PoC Publishing" width="472" height="96" class="aligncenter size-full wp-image-74732" /></a></p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_7.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_7.png" alt="Results of PoC Publishing" width="279" height="90" class="aligncenter size-full wp-image-74733" /></a></p>
<p>In this case, the check will not affect anything; however, the ADB version is really essential, since not all of the versions support a local connection with ADBD.</p>
<p>We analyzed several modifications of the second script, which allowed us to track the flow of thought of the malware writers. Apparently, their main goal was to deliver the APK file to the victim.</p>
<p>Thus, some earlier script modifications send data about each executed command to the control center:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_8.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_8.png" alt="Results of PoC Publishing" width="545" height="466" class="aligncenter size-full wp-image-74734" /></a></p>
<p>In this case, the SD card is checked for the MNAS.lock file. If it is not there, then the script tries to create the MNAS.APK file with a zero size by using a touch utility.</p>
<p>In later script modifications, the task of the APK file delivery to the victim was solved by using the ECHO command, which allows to create any file with any content on a device:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_9.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_9.png" alt="Results of PoC Publishing" width="693" height="79" class="aligncenter size-full wp-image-74735" /></a></p>
<p>As a result of the ECHO command execution, a malicious APK file is created on the SD card.</p>
<h2 id="trojan">Trojan</h2>
<p>The second script, in the state as we have discovered it, created and wrote a malicious file, which also needed to be executed, onto an SD card. Inasmuch as the dropper script does not contain a Trojan execution mechanism, the task has to be fulfilled by the user.</p>
<p>The APK file dropped from the script can be detected by Kaspersky Lab as Trojan-Spy.AndroidOS.SmsThief.ay. Since the beginning of 2016, we have managed to find four modifications of the Trojan.</p>
<p>Malware writers use the &#8220;example.training&#8221; name inside the Trojan code:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_10.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_10.png" alt="Results of PoC Publishing" width="684" height="230" class="aligncenter size-full wp-image-74736" /></a></p>
<p>At the same time, the malicious file has enough privileges to carry out fully fledged attacks onto the wallet of the victim by sending SMS messages:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_11.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_11.png" alt="Results of PoC Publishing" width="661" height="271" class="aligncenter size-full wp-image-74737" /></a></p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_12.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_12.png" alt="Results of PoC Publishing" width="640" height="55" class="aligncenter size-full wp-image-74738" /></a></p>
<p>The first action that the malicious code does after its execution is requesting administrator rights for the device. After obtaining the rights, it will conceal itself on the application list, thus making it difficult to detect and remove it:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_13.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_13.png" alt="Results of PoC Publishing" width="754" height="43" class="aligncenter size-full wp-image-74739" /></a></p>
<p>The Trojan will wait for incoming SMS messages. If they fall under given rules, for example, if the come from a number of one of the biggest Russian banks, then these messages will be forwarded at once to the malware writers as an SMS:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_14.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_14.png" alt="Results of PoC Publishing" width="650" height="63" class="aligncenter size-full wp-image-74740" /></a></p>
<p>Also, the intercepted messages will be forwarded to the server of the threat actors:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_15.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_15.png" alt="Results of PoC Publishing" width="869" height="227" class="aligncenter size-full wp-image-74741" /></a></p>
<p>Aside from the controlling server, the threat actors use a control number to communicate with the Trojan: the data exchange occurs within SMS messages.</p>
<p>The control number initially exists in the malicious code:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_16.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_16.png" alt="Results of PoC Publishing" width="317" height="193" class="aligncenter size-full wp-image-74742" /></a></p>
<p>The Trojan awaits specific commands from the control center and in SMS messages from the control number.</p>
<p>A command to change the control number can come from the server of threat actors:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_17.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/android_drive_eng_17.png" alt="Results of PoC Publishing" width="460" height="105" class="aligncenter size-full wp-image-74743" /></a></p>
<p>The following commands can come from a control number:</p>
<ul>
<li>SEND: send an SMS to an indicated number with indicated text;</li>
<li>STOP: stop forwarding SMS messages;</li>
<li>START: start forwarding SMS messages.</li>
</ul>
<p>For the moment, the functionality of the Trojan is limited to intercepting and sending SMS messages.</p>
<h2 id="conclusion">Conclusion</h2>
<p>The task of carrying out a mass attack on mobile users is solved by infecting a popular resource that harbors a malicious code that is capable of executing any threat actors&#8217; command on an infected mobile device. In case of the attacks described in the article, the emphasis has been placed on devices of Russian users: these devices are old and not up-to-date (notably, Russian domains have been infected). </p>
<p>It is unlikely that the interest of the malware writers towards drive-by attacks on mobile devices will decrease, and they will keep finding methods of carrying out these attacks.</p>
<p>It can be inferred that it is obvious that the attention of malware writers towards publications of research laboratories regarding the topic of Remote Code Execution vulnerabilities will increase, and the attempts to implement attacks by using mobile exploits will persist.</p>
<p>It is also obvious that no matter how enticing publishing is for a 0-day vulnerability, it is worth to refrain from showing detailed exploit examples (Proof of concept). Publishing the mentioned examples most likely will lead to someone creating a fully functional version of a malicious code.</p>
<p>There is a good news for the owners of old devices: our Kaspersky Internet Security solution is capable of protecting your device by tracking changes on the SD card in real time and removing a malicious code as soon as it is written to the SD card. Therefore, our users are protected from the threats known to Kaspersky Lab, which are delivered by the drive-by download method.</p>
]]></content:encoded>
			<wfw:commentRss>http://securelist.com/blog/research/74724/results-of-poc-publishing/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>IT threat evolution in Q1 2016</title>
		<link>http://securelist.com/analysis/quarterly-malware-reports/74640/it-threat-evolution-in-q1-2016/</link>
		<comments>http://securelist.com/analysis/quarterly-malware-reports/74640/it-threat-evolution-in-q1-2016/#comments</comments>
		<pubDate>Thu, 05 May 2016 10:57:53 +0000</pubDate>
		<dc:creator><![CDATA[Alexander Gostev]]></dc:creator>
				<category><![CDATA[Analysis]]></category>
		<category><![CDATA[Featured]]></category>
		<category><![CDATA[Quarterly Malware Reports]]></category>
		<category><![CDATA[APT]]></category>
		<category><![CDATA[Cyber espionage]]></category>
		<category><![CDATA[Financial malware]]></category>
		<category><![CDATA[Internet Banking]]></category>
		<category><![CDATA[Malware Statistics]]></category>
		<category><![CDATA[Mobile Malware]]></category>
		<category><![CDATA[Trojan-Bankers]]></category>
		<category><![CDATA[Vulnerabilities and exploits]]></category>

		<guid isPermaLink="false">https://kasperskycontenthub.com/securelist/?p=74640</guid>
		<description><![CDATA[2016 has only just got underway, but the first three months have already seen the same amount of cybersecurity events that just a few years ago would have seemed normal for a whole year. The main underlying trends remained the same, while there was significant growth in trends related to traditional cybercrime, especially mobile threats and global ransomware epidemics.]]></description>
				<content:encoded><![CDATA[<p><img width="500" height="334" src="http://securelist.com/files/2014/08/quarter_threat.jpg" class="attachment-securelist-huge-promo size-securelist-huge-promo wp-post-image" alt="quarter_threat" /></p><p><a href="https://kas.pr/8f6S"><img alt="" border="0" src="//securelist.com/files/2012/08/pdf_small5.gif" align="middle">&nbsp;<strong>Download PDF version</strong></a></p>
<h2 id="q1-figures">Q1 figures</h2>
<ul>
<li>According to KSN data, Kaspersky Lab solutions detected and repelled <b>228,420,754</b> malicious attacks from online resources located in 195 countries all over the world.</li>
<li><b>74,001,808</b> unique URLs were recognized as malicious by web antivirus components.</li>
<li>Kaspersky Lab&#8217;s web antivirus detected <b>18,610,281</b> unique malicious objects: scripts, exploits, executable files, etc.</li>
<li>There were <b>459,970</b> registered notifications about attempted malware infections that aim to steal money via online access to bank accounts.</li>
<li>Crypto ransomware attacks were blocked on <b>372,602</b> computers of unique users.</li>
<li>Kaspersky Lab&#8217;s file antivirus detected a total of <b>174,547,611</b> unique malicious and potentially unwanted objects.</li>
<li>Kaspersky Lab mobile security products detected:</li>
<ul>
<li><b>2,045,323</b> malicious installation packages;</li>
<li><b>4,146</b> mobile banker Trojans;</li>
<li><b>2,896</b> mobile ransomware Trojans.</li>
</ul>
</ul>
<h2 id="overview">Overview</h2>
<p>2016 has only just got underway, but the first three months have already seen the same amount of cybersecurity events that just a few years ago would have seemed normal for a whole year. The main underlying trends remained the same, while there was significant growth in trends related to traditional cybercrime, especially mobile threats and global ransomware epidemics.</p>
<p>Ransomware became the main theme of the quarter after knocking targeted attacks from the top of the most popular threat rating. Unfortunately, this is a situation that will continue to evolve, and those behind the extortion could well end up being named &#8220;problem of the year&#8221;.</p>
<h3 id="targeted-attacks">Targeted attacks</h3>
<h4 id="blackenergy23">BlackEnergy2/3</h4>
<p>The BlackEnergy cyberattack on the Ukrainian energy sector was the most high-profile incident. Although it occurred at the end of last year, a fuller picture of what happened only appeared in the course of the subsequent analysis. Moreover, attempts by cybercriminals to arrange new attacks continued in 2016.</p>
<p>The attack was unique because of the damage it caused – the hackers managed to disable the power distribution system in Western Ukraine, launch the Wiper program on the targeted systems and carry out a telephone DDoS on the technical support services of the affected companies.</p>
<p>There were numerous publications about the attack, and Kaspersky Lab&#8217;s experts revealed several aspects of the activities of the group responsible. In particular, they published an analysis of the tool used to penetrate the systems – a <a href="https://securelist.com/blog/research/73440/blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/">malicious DOC file</a>.</p>
<p>For those who want to learn more about the attack, we recommend the <a href="http://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf">report prepared by the American SANS</a> Institute and ICS-CERT.</p>
<h4 id="poseidon">Poseidon</h4>
<p>In February, the experts at Kaspersky Lab revealed details about the activities of Poseidon – the first Portuguese-speaking targeted attack group which had set up a </a><a href="https://securelist.com/blog/research/73673/poseidon-group-a-targeted-attack-boutique-specializing-in-global-cyber-espionage/">custom-tailored malware boutique</a>. </p>
<p>Although the report was only released in 2016, the group has been operational for a long time. Malware campaigns that were most probably supported by Poseidon were detected as far back as 2005, while the first sample dates back to 2001. Poseidon&#8217;s arsenal is focused primarily on the Microsoft Windows operating system family: from Windows 95, which the group targeted in its early days, to Windows 8.1 and Windows Server 2012, which were targeted by the most recently detected malware samples.</p>
<blockquote class="twitter-pullquote"><p>In Q1 2016, @kaspersky repelled 228M malicious attacks from online resources located in 195 countries #KLreport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74640%2Fit-threat-evolution-in-q1-2016%2F&#038;text=In+Q1+2016%2C+%40kaspersky+repelled+228M+malicious+attacks+from+online+resources+located+in+195+countries+%23KLreport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>The attack scenario is carefully tailored to the victim. Although the initial infection occurs according to the same scenario, the following stages of the campaign specifically customize the infection method for each new victim. That is why the specialists from the Global Research &amp; Analysis Team (GReAT) decided to call Poseidon a &#8220;custom-tailored malware boutique&#8221;.</p>
<p>Having gained access to the corporate network, the criminals move across the network and collect as much data as possible in order to escalate their privileges, create a network map and to identify the computer they need. The main target of the attack is usually the local Windows domain controller. Once they have control over it, the attackers can steal intellectual property, data, trade secrets, and other valuable information.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_1.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_1-1024x640.png" alt="IT threat evolution in Q1 2016" width="604" height="378" class="aligncenter size-large wp-image-74647" /></a></p>
<p>The information collected by Poseidon for its owners was in most cases used to blackmail victim companies into contracting the Poseidon Group as a security firm. Regardless of whether a contract was signed, Poseidon remained on the network.</p>
<h4 id="hacking-team">Hacking Team</h4>
<p>Yet another infamous &#8220;boutique&#8221; creating cyber-espionage tools, the Italian company Hacking Team, fell victim to a cyberattack last year in which a huge database of its employee email correspondence was stolen, as well as project source codes.</p>
<p>The incident revealed a lot of problems in the work of the company and many thought it would be very difficult for the business to develop further. However, at the beginning of 2016 new <a href="https://securelist.com/blog/research/74063/the-return-of-hackingteam-with-new-implants-for-os-x/">Hacking Team implants for OSX</a> were found. This indicates that the group has no intention of halting its work and is continuing to develop in the sphere of secondary operating systems. This means their &#8220;creations&#8221; will continue to be a problem for users who have become an object of interest for HT customers.</p>
<p>Yet another story related to Hacking Team was the <a href="https://securelist.com/blog/research/73255/the-mysterious-case-of-cve-2016-0034-the-hunt-for-a-microsoft-silverlight-0-day/">hunt for a Microsoft Silverlight 0-day</a>. Information about the possible presence of this vulnerability was found in the Italian company&#8217;s documents. Based on very little initial data and armed with the Yara and VirusTotal tools, our experts set a trap and waited. And sure enough, they detected a 0-day exploit. </p>
<h4 id="operation-blockbaster">Operation BLOCKBASTER</h4>
<p>Kaspersky Lab was among the participants in operation Blockbaster, a joint investigation conducted by several major IT security companies. The subject of the investigation was activity by <a href="https://securelist.com/blog/incidents/73914/operation-blockbuster-revealed/">the Lazarus Group</a>, a cybercriminal gang of supposedly North Korean origin that was involved in <a href="https://securelist.com/blog/research/67985/destover/">the attack on Sony Pictures in 2014</a>. </p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_2.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_2-1024x836.png" alt="IT threat evolution in Q1 2016" width="604" height="493" class="aligncenter size-large wp-image-74648" /></a></p>
<p>The Lazarus Group has been around since 2009, but their activities moved up a gear from 2011. The group is responsible for such well-known attacks as Troy, Dark Seoul (Wiper), WildPositron. During the investigation over 40 different types of malicious program, which they had created over the years, were detected. In particular, the group used their malware to attack companies, financial institutions, radio and television. Use of exploits for 0-day vulnerabilities was also recorded.</p>
<h4 id="hospitals-under-attack">Hospitals under attack</h4>
<p>This section on targeted attacks should also include Sergei Lozhkin&#8217;s research on how <a href="https://securelist.com/blog/research/74249/hospitals-are-under-attack-in-2016/">hackers can penetrate the internal network of hospitals</a> and gain full access to patient data using publicly available tools and services.</p>
<p>Unfortunately, medical institutions are being targeted more and more by such attacks. In the first quarter of 2016, there were several incidents of hospital networks being infected with various types of Trojan ransomware that encrypts data and <a href="http://www.wired.com/2016/03/ransomware-why-hospitals-are-the-perfect-targets/">demands a ransom</a> to decrypt it. </p>
<p>The latest incident was an attack on the MedStar network that affected 10 hospitals. According to the network&#8217;s official report, <a href="http://arstechnica.com/security/2016/04/maryland-hospital-group-denies-ignored-warnings-allowed-ransomware-attack/">the data was saved without paying a ransom</a> to the blackmailers, while another hospital in California <a href="http://arstechnica.com/security/2016/02/hospital-pays-17k-for-ransomware-crypto-key/">ended up paying $17,000</a> for a ransomware crypto key.</p>
<h3 id="cybercrime">Cybercrime</h3>
<h4 id="adwind">Adwind</h4>
<p>At the Security Analyst Summit 2016 (<a href="https://sas.kaspersky.com/">SAS 2016</a>) our GReAT experts presented the results of their investigation into the Trojan known as <a href="https://securelist.com/blog/research/73660/adwind-faq/">Adwind RAT</a> (Remote Access Tool). Having studied the activity of the malware, the researchers came to the conclusion that even the story behind the Trojan&#8217;s creation was out of the ordinary.</p>
<p>The Trojan was developed continuously over several years, with the first samples appearing in 2012. It has had different names at different times: in 2012, the creators were selling it as Frutas; in 2013 it was called Adwind; in 2014 the Trojan was known as Unrecom and AlienSpy; and in 2015 it was named JSocket.</p>
<p>The GReAT experts believe that Adwind and all its incarnations have been developed by one hard-working hacker who has been releasing new features and modules for four years.</p>
<p>The Adwind platform was initially only available in Spanish, but an English-language interface was added later, allowing cybercriminals worldwide to evaluate it. The main users of this Trojan are those conducting advanced cyber fraud, unscrupulous competitors, as well as so-called Internet mercenaries who are paid for spying on people and organizations online. Adwind can also be used by anyone wishing to spy on their friends.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_3.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_3-1024x836.png" alt="IT threat evolution in Q1 2016" width="604" height="493" class="aligncenter size-large wp-image-74649" /></a></p>
<p>Geographically, the biggest concentration of victims has also changed over the last four years. In 2013, the targets were mostly in Spanish- and Arabic-speaking countries. The following year, cybercriminals focused on Turkey and India, as well as the United Arab Emirates, the United States and Vietnam. In 2015, Russia topped the rating with the United Arab Emirates, Turkey, the United States and Germany close behind.</p>
<p>Fortunately, our investigation was not in vain – a few days after its publication, the JSocket website stopped working and the Adwind author ceased their activity. Since then, no new versions of the Trojan have appeared. Perhaps we can expect another reincarnation of the Trojan, or maybe this is the end of the story.</p>
<h4 id="banking-threats">Banking threats</h4>
<p>At the Security Analyst Summit (<a href="https://sas.kaspersky.com/">SAS in 2016</a>), Kaspersky Lab announced the discovery of two new gangs engaged in APT-style bank robberies – Metel and GCMAN – and the <a href="https://securelist.com/blog/research/73638/apt-style-bank-robberies-increase-with-metel-gcman-and-carbanak-2-0-attacks/">reemergence of the Carbanak group</a> with new targets in its sights. </p>
<p>In 2015, Kaspersky Lab researchers conducted incident response investigations for 29 organizations located in Russia that were infected by these three groups.</p>
<p>There are other cybercriminal groups currently attacking banks in Russia, but these three are the most active and are involved in the most high-profile thefts from both customer bank accounts and the banks themselves.</p>
<p>The activity of Carbanak 2.0 is of particular interest. In December 2015, Kaspersky Lab confirmed that the group was still active after discovering signs of Carbanak in a telecommunications company and a financial organization. An interesting feature of the Carbanak 2.0 group is that they have a different type of victim. The group has moved beyond banks and is now targeting the budgeting and accounting departments of any organization that interests them, using the same APT-style tools and techniques.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_4.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_4-1024x736.png" alt="IT threat evolution in Q1 2016" width="604" height="434" class="aligncenter size-large wp-image-74650" /></a></p>
<p>In one remarkable case, the Carbanak 2.0 gang used its access to a financial institution that stored information about shareholders to change the ownership details of a major company. The information was modified to name a money mule as a shareholder of the company, displaying their IDs. </p>
<h4 id="fakecert">FakeCERT</h4>
<p>Yet another criminal gang known as Buhtrap came to the fore in the first quarter. It is responsible not only for the theft of hundreds of millions of rubles from Russian banks but also for organizing a targeted attack on banks using the names and attributes of FinCERT, a special department of the Central Bank of Russia created to detect cyberattacks and notify member banks. It was the first time that attackers had used the FinCert &#8220;brand&#8221; and the attack was carefully prepared; a corresponding domain name was created and the identifiers used by FinCERT were studied closely.</p>
<p>The malicious mass mailing affected hundreds of banks in Russia. The attackers have a database of their employee email addresses, including names and surnames. A legitimate remote administration tool was used as the remote access module installed in the system.</p>
<h4 id="bangladesh">Bangladesh</h4>
<p>On the global arena, the most prominent attack on banks was that involving the <a href="http://www.business-standard.com/article/pti-stories/part-of-usd-100-mn-hacked-from-bangladesh-bank-recovered-116030701033_1.html">Central Bank of Bangladesh</a>. It was not just the object of the attack – the Central Bank – that was remarkable but also the amount of money the attackers managed to steal, plus the amount they tried to steal but failed.</p>
<p>The investigation is still ongoing, but according to the information that has been made public, it is possible to put together a picture of what happened. Back in early February, hackers managed to access the workstations of several employees at the national bank. Using their identities, the fraudsters began to send out transfer orders for money held in different banks including the New York Federal Reserve Bank. With full access and posing as employees, they were able to steal approximately $80 million. The money was transferred to accounts in the Philippines and then passed through a money-laundering scheme involving local casinos and forex brokers.</p>
<blockquote class="twitter-pullquote"><p>In Q1 2016, 74M unique malicious URLs recognized by @kaspersky #antivirus components #KLreport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74640%2Fit-threat-evolution-in-q1-2016%2F&#038;text=In+Q1+2016%2C+74M+unique+malicious+URLs+recognized+by+%40kaspersky+%23antivirus+components+%23KLreport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>Another $20 million would have been transferred to Sri Lanka, but the hackers made an error in the name of a recipient organization; this aroused the suspicion of Deutsche Bank, which was the correspondent bank of the Central Bank of Bangladesh. An investigation found that the payment order had been initiated by hackers, and approximately $900 million was still waiting to be transferred.</p>
<p>It&#8217;s worth noting that Bangladesh&#8217;s Minister of Finance only learned about the incident a month later from the mass media. The head of the Central Bank was forced to resign, the investigators are currently trying to trace those responsible, and the bank is taking measures to return at least some of the stolen funds.</p>
<h2 id="ransomware-trojans">Ransomware Trojans</h2>
<p>As we mentioned above, ransomware Trojans were the main theme of the quarter and could well become the main problem of the year.</p>
<p>Making the situation worse is the fact that a number of ransomware Trojans have become <a href="https://securelist.com/blog/research/73565/hidden-tear-and-its-spin-offs/">accessible to anyone with a little bit of cyber know-how</a> in the form of source code. As a consequence, even the average script-kiddy can deploy their own version of the Trojan which, together with the active use of Bitcoin for paying ransoms, makes it much easier to organize attacks with impunity. </p>
<p>Moreover, the term Ransomware-as-a-Service (RaaS) has already come into use. This involves the attackers offering to pay for Trojan distribution, promising a cut of any ransom money received. The clients of these services are usually webmasters of porn sites. There are services that work the <a href="http://www.bleepingcomputer.com/news/security/new-ransomware-as-a-service-announced-called-cryptolocker-service/">other way round</a>, offering a complete set of tools to the encryptor who takes responsibility for distributing the Trojan and takes 10% of the ransom as commission. </p>
<p>According to reports from several companies, the first quarter of 2016 saw incidents where <a href="http://www.reuters.com/article/us-china-ransomware-idUSKCN0WG2L5">ransomware was used by a number of well-known APT-groups</a>, mainly Chinese. We also identified similar cases, and not only involving Chinese groups. If these incidents become a trend, the threat will move to a new level because the damage caused by ransomware is not much different from that caused by Wiper-type Trojans. In both cases, user data becomes inaccessible.</p>
<p>In addition, ransomware Trojans are expanding their sphere of activity; in Q1 2016, <a href="https://securelist.com/blog/research/73989/ctb-locker-is-back-the-web-server-edition/">CTB-Locker targeted web servers</a>. </p>
<p>The earlier version of CTB-Locker known as crypto-ransomware Onion differed from other ransomware in that it used the anonymous network Tor to protect its command servers from being disabled because, as a rule, it is only possible to disable static servers. The use of Tor also helped the malware avoid detection and blocking. There was one more thing that protected CTB-Locker operators: payment was only accepted in Bitcoins, a decentralized anonymous cryptocurrency. </p>
<p>The new version of this malicious program encrypts web servers, and demands less than half a Bitcoin (~ $150) as ransom. If the money is not paid on time, the ransom is doubled to about $300. Once the ransom is paid, a key is generated to decrypt the web server files.</p>
<p>However, the biggest crypto epidemic of Q1 2016 was caused by the ransomware Trojan Locky (detected by Kaspersky Lab products as <a href="https://securelist.com/blog/research/74398/locky-the-encryptor-taking-the-world-by-storm/">Trojan-Ransom.Win32.Locky</a>). </p>
<p>This Trojan is continuing to spread; Kaspersky Lab products have recorded attempts to infect users in 114 countries around the world.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_5.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_5.png" alt="IT threat evolution in Q1 2016" width="890" height="526" class="aligncenter size-full wp-image-74651" /></a></p>
<p>In order to spread the Trojan, the cybercriminals use mass mailings in which malicious loaders are attached to spam messages. Initially, the malicious spam messages contained a DOC file attachment with a macro that downloaded the Locky Trojan from a remote server and executed it.</p>
<p>At the time of writing, the malicious spam is still being sent, but instead of DOC files being attached there are now ZIP archives containing one or more obfuscated scripts in JavaScript. The messages are mostly in English, though some bilingual variants have appeared.</p>
<p>The most significant technical innovation in ransomware was full disk encryption (more specifically, encryption of the file system table) rather than file encryption. This trick was used by the <a href="https://blog.kaspersky.com/petya-ransomware/11715/">Petya Trojan</a> (the fact that it has a Russian name does not necessarily mean that it was created by Russian-language malware writers).</p>
<p>After encrypting the main file table, Petya shows its true face – a skull and crossbones composed of ASCII characters. Then the typical encryptor routine begins: the Trojan demands a ransom from the victim, 0.9 Bitcoin (about $380) in this case.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_6.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_6-1024x1024.png" alt="IT threat evolution in Q1 2016" width="604" height="604" class="aligncenter size-large wp-image-74652" /></a></p>
<p>At this stage, the only thing that distinguishes Petya from other ransomware is the fact that it operates without an Internet connection. This is hardly surprising though, because Petya basically &#8220;eats&#8221; the operating system, including its ability to connect to the Internet. This means the user has to go to another computer to pay the ransom and recover their data.</p>
<p>In March, yet another encryptor for Mac OS X was discovered – Trojan-Ransom.OSX.KeRanger. The attackers used it to infect two BitTorrent client installers from the open source Transmission project, which were available for download on their official website. Most likely, the project site was hacked, and the files for download were substituted for malicious recompiled versions. The KeRanger Apple encryptor was signed with a valid Apple certificate, and could therefore bypass the Gatekeeper security feature. </p>
<h3 id="statistics-on-trojan-encryptors">Statistics on Trojan encryptors</h3>
<p>Encryptors belong to the Trojan-Ransom class of malware, i.e. to ransomware. Today, in addition to encryptors this class of malicious programs also includes so-called browser ransomware. In the general flow of Trojan-Ransom detections the share of browser ransomware accounts for 25%, and that is mainly in Russia and the CIS. In this section, we will not dwell on browser ransomware, but will look at malicious encryptors in more detail.</p>
<h4 id="the-number-of-new-trojan-ransom-encryptors">The number of new Trojan-Ransom encryptors</h4>
<p>The following graph represents the rise in the number of newly created encryptor modifications over the last two quarters.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_7.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_7.png" alt="IT threat evolution in Q1 2016" width="828" height="663" class="aligncenter size-full wp-image-74653" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Number of Trojan-Ransom encryptor modifications in Kaspersky Lab&#8217;s Virus Collection (Q4 2015 vs Q1 2016)</em></p>
<p>The overall number of encryptor modifications in our Virus Collection to date is at least 15,000. Nine new encryptor families and 2,900 new modifications were detected in Q1.</p>
<h4 id="the-number-of-users-attacked-by-encryptors">The number of users attacked by encryptors</h4>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_8.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_8.png" alt="IT threat evolution in Q1 2016" width="1017" height="658" class="aligncenter size-full wp-image-74654" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Number of users attacked by Trojan-Ransom encryptor malware (Q1 2016)</em></p>
<p>In Q1 2016, 372,602 unique users were attacked by encryptors, which is 30% more than in the previous quarter. Approximately 17% of those attacked were in the corporate sector.</p>
<p>It is important to keep in mind that the real number of incidents is several times higher: the statistics reflect only the results of signature-based and heuristic detections, while in most cases Kaspersky Lab products detect encryption Trojans based on behavior recognition models and issue the Generic verdict, which does not distinguish the types of malicious software. </p>
<h4 id="top-10-countries-attacked-by-encryptors">Top 10 countries attacked by encryptors</h4>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Country*</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">% of users attacked by encryptors**</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Italy</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.06</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Netherlands</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.81</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Belgium</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.58</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Luxembourg</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.36</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Bulgaria</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.31</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Croatia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.16</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Rwanda</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.15</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Lebanon</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.13</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Japan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.11</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Maldives</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.11</td>
</tr>
</table>
</div>
<p><small><i>* We excluded those countries in which the number of Kaspersky Lab product users is relatively small (less than 10,000).<br />
** Unique users whose computers have been targeted by Trojan-Ransom encryptor malware as a percentage of all unique users of Kaspersky Lab products in the country.</i></small></p>
<p>In Q1, the first six places in the Top 10 were occupied by European countries. Italy (3.06%) topped the rating; the most widespread encryptor family in this country was Teslacrypt (Trojan-Ransom.Win32.Bitman). Italy was followed by the Netherlands (1.81%) and Belgium (1.58%).</p>
<h4 id="top-10-most-widespread-encryptor-families">Top 10 most widespread encryptor families</h4>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Name</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Verdict*</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Percentage of users**</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Teslacrypt</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.Win32.Bitman/Trojan-Ransom.JS.Cryptoload</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">58.43%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">CTB-Locker</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.Win32.Onion/Trojan-Ransom.NSIS.Onion</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">23.49%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Cryptowall / Cryptodef</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.Win32.Cryptodef</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.41%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Cryakl</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.Win32.Cryakl</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.22%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Scatter</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.BAT.Scatter/Trojan-Downloader.JS.Scatter/Trojan-Dropper.JS.Scatter/Trojan-Ransom.Win32.Scatter</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2.47%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Rakhni</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.Win32.Rakhni/Trojan-Downloader.Win32.Rakhni</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.86%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Locky</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.Win32.Locky</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.30%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Shade</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.Win32.Shade</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.21%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">iTorLock / Troli</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.MSIL.Lortok</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.84%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Mor / Gulcrypt</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.Win32.Mor</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.78%</td>
</tr>
</table>
</div>
<p><small><i>* These statistics are based on detection verdicts received from users of Kaspersky Lab products who have consented to provide their statistical data. <br />** Unique users whose computers have been targeted by a specific Trojan-Ransom family as a percentage of all users of Kaspersky Lab products attacked by Trojan-Ransom malware.</i></small></p>
<p>First place in Q1 was occupied by the Teslacrypt family represented by two verdicts: Trojan-Ransom.Win32.Bitman and Trojan-Ransom.JS.Cryptoload. The second verdict is typical for scripts that are sent out in ZIP archives as part of spam mailings. In the past, these scripts downloaded malware such as Fareit and Cryptowall, but recently the attackers have switched to TeslaCrypt. Noticeably, in Q1 new versions of this encryptor with an improved encryption algorithm were spread this way: the authors used the &#8220;reliable&#8221; RSA-4096 instead of AES.</p>
<blockquote class="twitter-pullquote"><p>In Q1 2016, @kaspersky #web antivirus detected 18,610,281 unique malicious objects #KLreport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74640%2Fit-threat-evolution-in-q1-2016%2F&#038;text=In+Q1+2016%2C+%40kaspersky+%23web+antivirus+detected+18%2C610%2C281+unique+malicious+objects+%23KLreport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>Second came the <a href="https://securelist.com/analysis/publications/64608/a-new-generation-of-ransomware/">CTB-Locker</a> (Trojan-Ransom.Win32 / NSIS.Onion) family. The members of this family are usually distributed via an affiliate program, and are supported in many languages. As mentioned above, in the first quarter of 2016, a new variant of the <a href="https://securelist.com/blog/research/73989/ctb-locker-is-back-the-web-server-edition/">CTB-Locker that targets web servers only</a> was discovered. It has already successfully encrypted web-root files in more than 70 servers located in 10 countries.</p>
<p>The Trojan-Ransom.Win32.Cryptodef family also known as Cryptowall came third. Its representatives, as in the case of Teslacrypt, are spread via spam mass mailings.</p>
<p>In fifth place is the Scatter family. Earlier this year, a new wave of proliferation involving this encryptor via spam mailings was registered. The emails contained a link to a JS script that was masked in order to make the user download and launch it locally. Interestingly, when the script runs, in addition to Scatter, it saves two other malicious programs to the disk: Nitol (DDoS-bot) and Pony (a Trojan designed to steal information, mostly passwords).</p>
<p>The <a href="https://securelist.ru/blog/issledovaniya/28337/locky-the-encryptor-taking-the-world-by-storm/">Locky</a> family, which occupied seventh place in the Q1 rating, was notable for its wide geographic spread, mainly across Europe. Located on the Tor network, the site containing the criminals&#8217; demands supports more than two dozen languages, which doesn&#8217;t include Russian or other CIS languages. This may mean that cybercriminals are not interested in attacking victims in these countries, something that is confirmed by the KSN statistics.</p>
<h2 id="statistics">Statistics</h2>
<p><i>All the statistics used in this report were obtained using </i><a href="http://www.kaspersky.com/images/KESB_Whitepaper_KSN_ENG_final.pdf"><i>Kaspersky Security Network</i></a><i> (KSN), a distributed antivirus network that works with various anti-malware protection components. The data was collected from KSN users who agreed to provide it. Millions of Kaspersky Lab product users from 213 countries and territories worldwide participate in this global exchange of information about malicious activity.</i></p>
<h3 id="mobile-threats">Mobile threats</h3>
<p>Cybercriminals continue to improve <b>new techniques for deceiving users. </b>This quarter, we identified two mobile Trojans that counter standard security mechanisms used by operating systems. One version of <a href="https://securelist.com/blog/research/73211/the-asacub-trojan-from-spyware-to-banking-malware/">Trojan-Banker.AndroidOS.Asacub</a> overlays the regular system window requesting device administrator privileges with its own window containing buttons. The Trojan thereby conceals the fact that it is gaining elevated privileges in the system from the user, and tricks the user into approving these privileges. Another Trojan using a similar method is Trojan-SMS.AndroidOS.Tiny.aw. In recent versions of Android the system asks for the user&#8217;s approval when an SMS is sent to a premium number. The Tiny SMS Trojan overlays this dialog with its own screen without covering the buttons in the original window.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_9.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_9-232x300.png" alt="q1_2016_mw_en_9" width="232" height="300" class="aligncenter size-medium wp-image-74655" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Request screen of Trojan-SMS.AndroidOS.Tiny.aw overlaying a notification about the sending of an SMS to a premium-rate number <i>(The message states: Would you like to send a request to receive a gaming database?)</i></em></p>
<p>The Trojan&#8217;s request is presented in such a way that the user will most probably agree to send the SMS to a premium-rate number without having the vaguest idea of what happened next. </p>
<p>In the <a href="https://securelist.com/analysis/quarterly-malware-reports/72493/it-threat-evolution-in-q3-2015/">Q3 2015 report</a> we mentioned the banking Trojan Trojan-Banker.AndroidOS.Marcher. This quarter, we were able to detect <b>new versions of Marcher</b> which attacked nearly 40 banking apps, mostly belonging to European banks. Unlike most other mobile Trojans, Marcher uses phishing web pages rather than its own windows to overlay banking app screens. </p>
<p>In Q1, we saw an<b> increase in activity by the mobile ransomware Trojan-Ransom.AndroidOS.Fusob.pac,</b> which blocks the user&#8217;s device and demands a ransom for decryption. In the first three months of 2016, Fusob became the most popular mobile Trojan of this type – it accounted for over 64% of users attacked by mobile ransomware. The total number of users attacked by mobile ransomware Trojans increased more than 1.8 times compared to the previous quarter.</p>
<h4 id="the-number-of-new-mobile-threats">The number of new mobile threats</h4>
<p>In Q1 2016, Kaspersky Lab detected <b>2,045,323</b> malicious installation packages – this is 11 times greater than in Q4 2015, and 1.2 times more than in Q3 2015.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_10.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_10.png" alt="IT threat evolution in Q1 2016" width="1009" height="658" class="aligncenter size-full wp-image-74656" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Number of detected malicious installation packages (Q2 2015 – Q1 2016)</em></p>
<h4 id="distribution-of-mobile-malware-by-type">Distribution of mobile malware by type</h4>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_11.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_11.png" alt="IT threat evolution in Q1 2016" width="1354" height="790" class="aligncenter size-full wp-image-74657" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of new mobile malware by type, Q1 2016 vs. Q4 2015</em></p>
<p>In Q1 2016, adware programs continued to top the rating of detected malicious objects for mobile devices. The share of adware programs grew 13 p.p. compared to Q4 2015, and reached 42.7%. Notably, this is lower than in Q3 2015 (52.5%). </p>
<p>Second place is occupied by an SMS Trojan, and it is the second quarter in a row that we have seen a growth in the share of detections of this type of object. In Q4 2015, the share of SMS Trojans rose dramatically from 6.2% to 19.8%, and grew by another 0.7 p.p. in Q1 2016, and amounted to 20.5%. </p>
<p>Trojan spyware programs, with a 10% share, were right behind the SMS Trojans. These programs steal the user&#8217;s personal data, including incoming messages (mTANs) from banks.</p>
<p>RiskTool software, or legal applications that are potentially dangerous to users, had occupied the first or second position in this rating for nearly two years. However, starting in Q4 2015 they fell to the fifth place. In Q4 2014, there share was 5.6%, and in Q1 2016 7.4%.</p>
<p>The share of banking Trojans has continued to grow, and amounted to 1.2% in Q1 2016.</p>
<h4 id="top-20-mobile-malware-programs">TOP 20 mobile malware programs</h4>
<p>Please note that this ranking of malicious programs does not include potentially dangerous or unwanted programs such as RiskTool or adware.</p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Name</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">% of attacked users*</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">DangerousObject.Multi.Generic</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">73.7</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Backdoor.AndroidOS.Ztorg.c</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">11.3</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan.AndroidOS.Iop.c</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8.9</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan.AndroidOS.Ztorg.a</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8.7</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Ransom.AndroidOS.Fusob.pac</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6.2</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Dropper.AndroidOS.Agent.ar</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4.6</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Clicker.AndroidOS.Gopl.a</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4.5</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Backdoor.AndroidOS.Ztorg.b</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4.3</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan.AndroidOS.Iop.m</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.7</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan.AndroidOS.Agent.ej</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.7</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">11</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan.AndroidOS.Iop.q</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.5</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">12</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan.AndroidOS.Ztorg.i</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.3</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">13</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan.AndroidOS.Muetan.b</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.1</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">14</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan.AndroidOS.Agent.gm</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.1</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">15</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-SMS.AndroidOS.Podec.a</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.1</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">16</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Downloader.AndroidOS.Leech.a</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.0</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">17</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Dropper.AndroidOS.Guerrilla.b</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2.8</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">18</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Exploit.AndroidOS.Lotoor.be</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2.8</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">19</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Backdoor.AndroidOS.Ztorg.a</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2.8</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">20</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Backdoor.AndroidOS.Triada.d</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2.4</td>
</tr>
</table>
</div>
<p><small><i>* Percentage of users attacked by the malware in question, relative to all users attacked</i></small></p>
<p>First place is occupied by DangerousObject.Multi.Generic (44.2%), used for malicious programs detected by cloud technologies. Cloud technologies work when the antivirus database contains neither the signatures nor heuristics to detect a malicious program, but the cloud of the antivirus company already contains information about the object. This is basically how the very latest malware is detected.</p>
<p>An increasing number of entries in the TOP 20 are occupied by Trojans that use advertising as their main means of monetization. Their goal is to deliver as much advertisements as possible to the user, employing various methods, including the installation of new adware. These Trojans may use superuser privileges to conceal themselves in the system application folder, from which it will be very difficult to delete them. In Q1, 16 such programs made it into the TOP 20: three programs from the family Backdoor.AndroidOS.Ztorg, three from the family Trojan.AndroidOS.Iop, two from the family Trojan.AndroidOS.Ztorg, plus Trojan-Dropper.AndroidOS.Agent.ar, Trojan-Clicker.AndroidOS.Gopl.a, Trojan.AndroidOS.Agent.ej, Trojan.AndroidOS.Muetan.b, Trojan.AndroidOS.Agent.gm, Trojan-Downloader.AndroidOS.Leech.a, Trojan-Dropper.AndroidOS.Guerrilla.b, and Backdoor.AndroidOS.Triada.d.</p>
<p><a href="https://securelist.com/analysis/publications/74032/attack-on-zygote-a-new-twist-in-the-evolution-of-mobile-threats/">Backdoor.AndroidOS.Triada</a> is a new entry in the TOP 20 of mobile malware. The main function of this Trojan is to redirect financial SMS transactions when the user makes online payments to buy additional content in legitimate apps. The money goes to the attackers rather than to the software developer. Triada is the most complex mobile malware program that we know of. Its distinctive feature is the use of the Zygote process to implement its code in the context of all the applications on the device. Triada penetrates virtually all applications running on the infected device, and continues to exist in the RAM memory only. In addition, all the Trojan&#8217;s separately launched processes are concealed from the user and other applications.</p>
<p>The ransomware Trojan Trojan-Ransom.AndroidOS.Fusob.pac is in fifth place (6.2%). This Trojan demands a $200 ransom from victims to unblock their devices. A substantial number of the victims are located in North America (the US and Canada) and Europe (mostly in Germany, Italy, the UK, Spain and Switzerland).</p>
<p>Trojan-SMS.AndroidOS.Podec.a (3%) has spent over a year now in the mobile malware TOP 20, although now it is beginning to lose ground. Earlier it was consistently among the top 5 mobile threats, but in Q1 2016 it only made it into the bottom half of the rating. The number of users attacked by this Trojan fell 1.7 times compared to Q4 2015. Its functionality has remained practically unchanged; the main means of monetization is still achieved by subscribing the user to paid services.</p>
<p>Also making it into the rating is Exploit.AndroidOS.Lotoor.be, an exploit used to gain local super-user rights.</p>
<h4 id="the-geography-of-mobile-threats">The geography of mobile threats</h4>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_12.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_12.png" alt="IT threat evolution in Q1 2016" width="890" height="526" class="aligncenter size-full wp-image-74658" /></a></p>
<p style="text-align:center;font-weight:bold"><em>The geography of mobile malware infection attempts in Q1 2016 (percentage of all users attacked)</em></p>
<p><b>Top 10 counties attacked by mobile malware (ranked by percentage of users attacked)</b></p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"> </td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Country*</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">% of users attacked**</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">China</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">38.2</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Bangladesh</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">27.6</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Uzbekistan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">21.3</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Algeria</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">17.6</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Nigeria</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">17,4</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">India</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">17.0</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Philippines</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">15.7</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Indonesia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">15,6</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Ukraine</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">15.0</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Malaysia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">14.0</td>
</tr>
</table>
</div>
<p><small><i>* We eliminated countries from this ranking where the number of users of Kaspersky Lab&#8217;s mobile security product is lower than 10,000.<br />
** Percentage of unique users attacked in each country relative to all users of Kaspersky Lab&#8217;s mobile security product in the country.</i></small></p>
<p>China topped the ranking, with 40% of users encountering a mobile threat at least once during the year. To recap, in <a href="https://securelist.com/analysis/kaspersky-security-bulletin/73839/mobile-malware-evolution-2015/">2015 China</a> also came first in the ranting. </p>
<p>In all the countries of the Top 10 except for China the most popular mobile malware was the same – advertising Trojans that appeared in the TOP 20 mobile malware, and AdWare. In China, a significant proportion of attacks also involved advertising Trojans, but the majority of users encountered the Backdoor.AndroidOS.GinMaster and Backdoor.AndroidOS.Fakengry families. Representatives of the RiskTool.AndroidOS.SMSreg family were also popular. If used carelessly, these programs could result in money being withdrawn from a mobile account.</p>
<p>The safest countries are Taiwan (2.9%), Australia (2.7%) and Japan (0.9%).</p>
<h4 id="mobile-banking-trojans">Mobile banking Trojans</h4>
<p>Over the reporting period, we detected 4,146 mobile Trojans, which is 1.7 times more than in the previous quarter.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_13.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_13.png" alt="IT threat evolution in Q1 2016" width="1264" height="692" class="aligncenter size-full wp-image-74659" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Number of mobile banking Trojans detected by Kaspersky Lab solutions (Q2 2015 – Q1 2016)</em></p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_14.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_14.png" alt="IT threat evolution in Q1 2016" width="890" height="526" class="aligncenter size-full wp-image-74660" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Geography of mobile banking threats in Q1 2016 (number of users attacked)</em></p>
<p>The number of attacked users depends on the overall number of users within each individual country. To assess the risk of a mobile banker Trojan infection in each country, and to compare it across countries, we created a country ranking according to the percentage of users attacked by mobile banker Trojans. </p>
<p><b>Top 10 counties attacked by mobile banker Trojans (ranked by percentage of users attacked)</b></p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"> </td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Country*</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">% users attacked**</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">China</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.45</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Australia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.30</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Russia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.24</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Uzbekistan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.20</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Ukraine</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.08</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">France</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.06</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Belorussia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.05</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Turkey</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.05</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Japan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.03</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Kazakhstan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.03</td>
</tr>
</table>
</div>
<p><small><i>* We eliminated countries from this ranking where the number of users of Kaspersky Lab&#8217;s mobile security product is lower than 10,000.<br />
** Percentage of unique users in each country attacked by mobile banker Trojans, relative to all users of Kaspersky Lab&#8217;s mobile security product in the country.</i></small></p>
<p>In Q1 2016, first place was occupied by China where the majority of affected users encountered the Backdoor.AndroidOS.GinMaster and Backdoor.AndroidOS.Fakengry families of mobile banker Trojans. In second place was Australia where the Trojan-Banker.AndroidOS.Acecard family was replaced by the Trojan-Banker.AndroidOS.Marcher family as the most popular threat. </p>
<p><b>TOP 10 countries by the percentage of users attacked by mobile banking Trojans relative to all attacked users</b></p>
<p>An indication of how popular mobile banker Trojans are with cybercriminals in each country can be provided by the percentage of users who were attacked at least once by mobile banker Trojans during the quarter, relative to all users in the same country whose mobile security product was activated at least once in the reporting period. This ranking differs from the one above:</p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"> </td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Country*</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">% users attacked**</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Australia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">13.4</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Russia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5.1</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">United Kingdom</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.6</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Turkey</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.4</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Austria</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.3</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">France</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.3</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Poland</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.2</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">China</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.1</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Hong Kong</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Switzerland</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.9</td>
</tr>
</table>
</div>
<p><small><i>* We eliminated countries from this ranking where the number of users of Kaspersky Lab&#8217;s mobile security product is lower than 10,000.<br />
** Percentage of unique users in each country attacked by mobile banker Trojans, relative to all unique users attacked by mobile malware in the country.</i></small></p>
<p>To recap, Australia was among the Top 3 countries with the lowest percentage of users attacked by mobile malware. However, in this ranking Australia ended in first place: more than 13% of all users attacked by mobile malicious programs were attacked by mobile bankers. Meanwhile China, which came first in the previous ranking, ended the quarter in tenth place. In other words, in China the cybercriminals&#8217; mobile banking Trojans are less popular than other types of mobile malware.</p>
<h4 id="mobile-trojan-ransom">Mobile Trojan-Ransom</h4>
<p>In Q1 2016, we detected 2,896 mobile ransomware samples, which is 1.4 times more than in the previous quarter. </p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_15.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_15.png" alt="IT threat evolution in Q1 2016" width="1264" height="692" class="aligncenter size-full wp-image-74661" /></a></p>
<p style="text-align:center;font-weight:bold"><em>&gt;Number of mobile Trojan-Ransomware programs detected by Kaspersky Lab (Q2 2015 – Q1 2016)</em></p>
<p><b>TOP 10 countries attacked by Trojan-Ransomware as a percentage of attacked users:</b></p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"> </td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Country*</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">% of users attacked **</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Kazakhstan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.92</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Germany</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.83</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Uzbekistan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.80</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Canada</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.71</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Italy</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.67</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Netherlands</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.66</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">United Kingdom</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.59</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Switzerland</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.58</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">USA</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.55</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Spain</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">0.36</td>
</tr>
</table>
</div>
<p><small><i>* We eliminated countries from this ranking where the number of users of Kaspersky Lab&#8217;s mobile security product is lower than 10,000.<br />
** Percentage of unique users in each country attacked by mobile banker Trojans, relative to all users attacked by mobile malware in the country.</i></small></p>
<p>In all the countries of the TOP 10, except for Kazakhstan and Uzbekistan, the most popular Trojan-Ransom family was Fusob, especially its Trojan-Ransom.AndroidOS.Fusob.pac modification (note, this malicious program was fifth in the ranking of mobile threats).</p>
<p>In Kazakhstan and Uzbekistan, which came first and third respectively, the main threat to users originated from representatives of the Small family of mobile Trojan-Ransom. This is a fairly simple ransomware program that blocks operation of a device by overlaying all the windows on the device with its own window and demands $10 to unblock it.</p>
<h4 id="vulnerable-applications-used-by-cybercriminals">Vulnerable applications used by cybercriminals</h4>
<p>In Q1 2016, exploits for Adobe Flash Player remained popular. During the reporting period two new vulnerabilities in this software were detected:</p>
<ul>
<li>CVE-2015-8651</li>
<li>CVE-2016-1001</li>
</ul>
<p>The first exploit pack to add support for these vulnerabilities was Angler.</p>
<p>One notable event in the first quarter was the <a href="https://securelist.com/blog/research/73255/the-mysterious-case-of-cve-2016-0034-the-hunt-for-a-microsoft-silverlight-0-day/">use of an exploit for Silverlight &#8211; CVE-2016-0034</a>. At the time of publication, this vulnerability is used by the Angler and RIG exploit packs.</p>
<p>As is now traditional, some popular packs included an exploit for the Internet Explorer (CVE-2015-2419) vulnerability.</p>
<p>The overall picture of the use of exploits in the first quarter looks as follows:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_16.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_16-1024x789.png" alt="IT threat evolution in Q1 2016" width="604" height="465" class="aligncenter size-large wp-image-74662" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of exploits used in attacks by the type of application attacked, Q1 2016</em></p>
<p>As expected, we have seen a decline in the share of exploits for Java (-3 percentage points) and an increase in the use of Flash exploits (+1 p.p.). There was also a significant increase in the percentage of exploits for Microsoft Office (+10 p.p.): this group mainly includes exploits for vulnerabilities in Microsoft Word. This significant growth was caused by spam mailings containing these exploits. </p>
<blockquote class="twitter-pullquote"><p>In Q1 2016, @kaspersky blocked #crypto #ransomware attacks on 372,602 computers of unique users #KLreport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74640%2Fit-threat-evolution-in-q1-2016%2F&#038;text=In+Q1+2016%2C+%40kaspersky+blocked+%23crypto+%23ransomware+attacks+on+372%2C602+computers+of+unique+users+%23KLreport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>Overall, the first quarter of 2016 continued the trend of the past few years – cybercriminals are focused on exploits for Adobe Flash Player and Internet Explorer. In our chart, the latter is included in the &#8220;Browsers&#8221; category together with detections of landing pages that &#8220;distribute&#8221; exploits.</p>
<h3 id="online-threats-web-based-attacks">Online threats (Web-based attacks)</h3>
<p><i>The statistics in this section were derived from web antivirus components that protect users from attempts to download malicious objects from a malicious/infected website. Malicious websites are created deliberately by malicious users; infected sites include those with user-contributed content (such as forums), as well as compromised legitimate resources.</i></p>
<p>In the first quarter of 2016, Kaspersky Lab&#8217;s web antivirus detected 18,610,281 unique malicious objects: scripts, exploits, executable files, etc. 74,001,808 unique URLs were recognized as malicious by web antivirus components.</p>
<h4 id="online-threats-in-the-banking-sector">Online threats in the banking sector</h4>
<p>In the first three months of 2016, Kaspersky Lab solutions blocked attempts to launch malware capable of stealing money via online banking on 459,970 computers. We are witnessing a decline in financial malware activity: the figure for Q1 is 23.3% lower than in the previous quarter (597,415). A year ago, in Q1 2015 this figure was 699,652, which translates into a 34.26% fall in the number of victims over the past year.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_17.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_17.png" alt="IT threat evolution in Q1 2016" width="1017" height="668" class="aligncenter size-full wp-image-74663" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Number of attacks by financial users, Q1 2016</em></p>
<h5 id="geography-of-attacks">Geography of attacks</h5>
<p>To evaluate and compare the degree of risk of being infected by banking Trojans worldwide, we calculate the percentage of Kaspersky Lab product users who encountered this type of threat during the reporting period in the country, relative to all users of our products in the county.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_18.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_18.png" alt="IT threat evolution in Q1 2016" width="890" height="526" class="aligncenter size-full wp-image-74664" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Geography of banking malware attacks in Q1 2016 (percentage of attacked users)</em></p>
<p><b>Top 10 countries by the percentage of attacked users</b></p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Country*</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">% attacked users**</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Brazil</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3.86</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Austria</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2.09</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Tunisia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.86</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Singapore</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.83</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Russia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.58</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Venezuela</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.58</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Morocco</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.43</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Bulgaria</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.39</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Hong Kong</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.37</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">United Arab emirates</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1.30</td>
</tr>
</table>
</div>
<p><small><em>These statistics are based on the detection verdicts returned by the antivirus module, received from users of Kaspersky Lab products who have consented to provide their statistical data.</em><br />
<em>* We excluded those countries in which the number of Kaspersky Lab product users is relatively small (less than 10,000).</em><br />
<em>** Unique users whose computers have been targeted by banking Trojan attacks as a percentage of all unique users of Kaspersky Lab products in the country.</em></small></p>
<p>In Q1 2016, Brazil had the highest percentage of Kaspersky Lab users who were attacked by banking Trojans. One of the reasons for the growth of financial threats in this country was the <a href="https://securelist.com/blog/research/74051/first-step-in-cross-platform-trojan-bankers-from-brazil-done/">emergence</a> of cross-platform Trojan bankers. Noticeably, most countries in the TOP 10 have a high level of technological development and/or well-developed banking system which attracts cybercriminals.</p>
<p>In Russia, 1.58% of users encountered a banking Trojan at least once in Q1 (an increase of 1 p.p. compared to the previous quarter). In the US, the figure was 0.26%; Spain &#8211; 0.84%; Italy &#8211; 0.79%; Germany &#8211; 0.52%; the UK &#8211; 0.48%; France &#8211; 0.36%.</p>
<h5 id="the-top-10-banking-malware-families">The Top 10 banking malware families</h5>
<p>The table below shows the Top 10 malware families most commonly used in Q1 2016 to attack online banking users:</p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"> </td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Name</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Number of users attacked</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Spy.Win32.Zbot</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">419940</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Downloader.Win32.Upatre</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">177665</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Banker.Java.Agent</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">68467</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Banker.Win32.Gozi</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">53978</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Banker.Win32.BestaFera</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">25923</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan.Win32.Tinba</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">24964</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Banker.Win32.Banbra</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">22942</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Banker.AndroidOS.Agent</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">19782</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Banker.AndroidOS.Abacus</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">13446</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Trojan-Banker.Win32.ChePro</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9209</td>
</tr>
</table>
</div>
<p>Trojan-Spy.Win32.Zbot topped the ranking. It has become a permanent resident in this ranking, and it is no coincidence that it consistently occupies a leading position. The Trojans of the Zbot family were among the first to use web injections to compromise the payment details of online banking users and to modify the contents of banking web pages. They encrypt their configuration files at several levels; the decrypted configuration file is never stored in the memory in its entirety, but is instead loaded in parts. </p>
<p>The Trojan-Downloader.Win32.Upatre family of malicious programs came second in Q1 2016. The malware is no larger than 3.5 KB in size, and is limited to downloading the payload to the victim computer, most typically a banker Trojan from the Dyre/Dyzap/Dyreza family. The main aim of this family of banking Trojans is to steal the user&#8217;s payment details. Dyre does this by intercepting the data from a banking session between the victim&#8217;s browser and the online banking web app, in other words, it uses the &#8220;Man-in-the-Browser&#8221; (MITB) technique.</p>
<p>It is worth noting that the vast majority of the TOP 10 malware uses the technique of embedding arbitrary HTML code in the web page displayed by the browser and intercepting payment data entered by the user into the original and the inserted web forms.</p>
<p>The TOP 3 threats in the first quarter of 2016 include cross-platform banking malware written in Java. Brazilian cybercriminals have started actively using cross-platform Java Trojans. In addition, Kaspersky Lab experts detected new malicious software also written in Java and used to steal financial information – <a href="https://securelist.com/blog/research/74051/first-step-in-cross-platform-trojan-bankers-from-brazil-done/">Adwind RAT</a>. Adwind is written entirely in Java, which is why it can attack all popular platforms: Windows, Mac OS, Linux and Android. The malicious program allows attackers to collect and extract data from the system, as well as remotely control an infected device. To date, it is able to take screenshots, memorize keystrokes, steal passwords and data stored in browsers and web forms, take photos and videos via the webcam, make audio recordings using the microphone built into the device, collect general data about the user and the system, steal VPN certificates and keys from crypto currency wallets and, finally, manage SMS.</p>
<blockquote class="twitter-pullquote"><p>In Q1 2016, @kaspersky #mobile products detected 2M malicious installation packages #KLreport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74640%2Fit-threat-evolution-in-q1-2016%2F&#038;text=In+Q1+2016%2C+%40kaspersky+%23mobile+products+detected+2M+malicious+installation+packages+%23KLreport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>Fourth place in the TOP 10 is occupied by Trojan-Banker.Win32.Gozi, which penetrates working processes of popular web browsers to steal payment information. Some samples of this Trojan can infect the MBR (Master Boot Record) and maintain their presence in the operating system, even if it has been reinstalled.</p>
<p>One of the most interesting pieces of malware designed to steal financial data that did not make it into the TOP 10 is Gootkit. It is written using the software platform NodeJS and has a modular architecture. The malicious code interpreter is contained in its body; as a result, it is big &#8211; approximately 5 MB. To steal payment data, Gootkit uses http traffic interception and embeds itself in the browser. Other standard Trojan features include execution of arbitrary commands, auto-update, and capturing screenshots. However, this banking Trojan is not particularly widespread.</p>
<h4 id="top-10-countries-where-online-resources-are-seeded-with-malware">Top 10 countries where online resources are seeded with malware</h4>
<p><i>The following statistics are based on the physical location of the online resources that were used in attacks and blocked by our antivirus components (web pages containing redirects to exploits, sites containing exploits and other malware, botnet command centers, etc.). Any unique host could be the source of one or more web attacks.</i></p>
<p><i>In order to determine the geographical source of web-based attacks, domain names are matched up against their actual domain IP addresses, and then the geographical location of a specific IP address (GEOIP) is established.</i></p>
<p>In Q1 2016, Kaspersky Lab solutions blocked 228,420,754 attacks launched from web resources located in 195 countries around the world. 76% of notifications on blocked web attacks were triggered by attacks coming from web resources located in 10 countries.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_19.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_19-1024x689.png" alt="IT threat evolution in Q1 2016" width="604" height="406" class="aligncenter size-large wp-image-74665" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of web attack sources by country, Q1 2016</em></p>
<p>Q1 saw the Netherlands take over first place (24.6%) from the US (21.44%). Russia (7.45%) and Germany (6%), which followed them, also swapped places. Vietnam has dropped out the Top 10, while Bulgaria is a newcomer in eighth place with 1.75%. </p>
<p>Countries where users faced the greatest risk of online infection</a></p>
<p>In order to assess the risk of online infection faced by users in different countries, we calculated the percentage of Kaspersky Lab users in each country who encountered detection verdicts on their machines during the quarter. The resulting data provides an indication of the aggressiveness of the environment in which computers work in different countries.</p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Country*</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">% of unique users attacked **</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Russia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">36.28</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Kazakhstan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">33.19</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">China</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">32.87</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Azerbaijan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">30.28</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Ukraine</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">29.96</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Belarus</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">29.16</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Slovenia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">26.88</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Armenia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">26.27</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Vietnam</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">25.14</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Moldova</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">24.68</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">11</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Kyrgyzstan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">24.46</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">12</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Spain</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">24.00</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">13</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">India</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">23.98</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">14</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Brazil</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">23.68</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">15</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Italy</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">22.98</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">16</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Algeria</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">22.88</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">17</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Lithuania</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">22.58</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">18</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Croatia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">22.04</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">19</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Turkey</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">21.46</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">20</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">France</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">21.46</td>
</tr>
</table>
</div>
<p><small><i>These statistics are based on the detection verdicts returned by the web antivirus module, received from users of Kaspersky Lab products who have consented to provide their statistical data.</i></small></p>
<p><small><i>* These calculations excluded countries where the number of Kaspersky Lab users is relatively small (fewer than 10,000 users).<br />
** Unique users whose computers have been targeted by web attacks as a percentage of all unique users of Kaspersky Lab products in the country.</i></small></p>
<p>The leader of this ranking remained unchanged – it is still Russia with 36.3%. Since the previous quarter, Chile, Mongolia, Bulgaria and Nepal have left the Top 20. Newcomers to the ranking are Slovenia (26.9%), India (24%) and Italy (23%).</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_20.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_20.png" alt="IT threat evolution in Q1 2016" width="890" height="526" class="aligncenter size-full wp-image-74666" /></a></p>
<p>The countries with the safest online surfing environments included Germany (17.7%), Canada (16.2%), Belgium (14.5%), Switzerland (14%), the US (12.8%), the UK (12.7%), Singapore (11.9%), Norway (11.3%), Honduras (10.7%), the Netherlands (9.6%) and Cuba (4.5%).</p>
<p>On average, 21.42% of computers connected to the Internet globally were subjected to at least one web attack during the three months. This is a fall of 1.5 p.p. compared to Q4 2015.</p>
<h3 id="local-threats">Local threats</h3>
<p><i>Local infection statistics for users computers are a very important indicator: they reflect threats that have penetrated computer systems using means other than the Internet, email, or network ports. </i></p>
<p><i>Data in this section is based on analyzing statistics produced by antivirus scans of files on the hard drive at the moment they were created or accessed, and the results of scanning removable storage media.</i></p>
<p>In Q1 2016, Kaspersky Lab&#8217;s file antivirus detected a total of 174,547,611 unique malicious and potentially unwanted objects.</p>
<h4 id="countries-where-users-faced-the-highest-risk-of-local-infection">Countries where users faced the highest risk of local infection</h4>
<p>For each of the countries, we calculated the percentage of Kaspersky Lab product users on whose computers the file antivirus had been triggered during the quarter. These statistics reflect the level of personal computer infection in different countries.</p>
<p><b>Top 20 countries with the highest levels of computer infection</b></p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tbody>
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"> </td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Country*</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">% of unique users**</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Somalia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">66.88%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Yemen</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">66.82%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Armenia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">65.17%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Kyrgyzstan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">64.45%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Russia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">64.18%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">6</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Tajikistan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">64.06%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">7</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Bangladesh</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">63.00%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Vietnam</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">61.31%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">9</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Afghanistan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">60.72%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">10</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Kazakhstan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">60.62%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">11</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Nepal</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">59.60%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">12</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Uzbekistan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">59.42%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">13</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Ethiopia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">59.23%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">14</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Ukraine</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">58.90%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">15</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Belorussia</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">58.51%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">16</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Laos</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">58.46%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">17</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Rwanda</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">58.10%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">18</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Iraq</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">57.16%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">19</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Algeria</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">57.50%</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">20</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Moldova</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">56.93%</td>
</tr>
</tbody>
</table>
</div>
<p><small><i>These statistics are based on the detection verdicts returned by on-access and on-demand antivirus modules, received from users of Kaspersky Lab products who have consented to provide their statistical data. The data include detections of malicious programs located on users&#8217; computers or on removable media connected to the computers, such as flash drives, camera and phone memory cards, or external hard drives.</i></small></p>
<p><small><i>* These calculations exclude countries where the number of Kaspersky Lab users is relatively small (fewer than 10,000 users).</i></small></p>
<p><small><i>** The percentage of unique users in the country with computers that blocked local threats as a percentage of all unique users of Kaspersky Lab products.</i></small></p>
<blockquote class="twitter-pullquote"><p>In Q1 2016, @kaspersky #mobile products detected 2,896 mobile #ransomware Trojans #KLreport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74640%2Fit-threat-evolution-in-q1-2016%2F&#038;text=In+Q1+2016%2C+%40kaspersky+%23mobile+products+detected+2%2C896+mobile+%23ransomware+Trojans+%23KLreport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>Somalia became the new leader of this rating in Q1, with 66.9%. Bangladesh, the leader for the past few quarters, dropped to seventh place (63.6%). Newcomers to this ranking are Uzbekistan in 12th place (59.4%), Ukraine in 14th place (58.9%), Belarus in 15th place (58.5%), Iraq in 18th place (57.2%) and Moldova in 20th (57.0%).</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_21.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/05/q1_2016_mw_en_21.png" alt="IT threat evolution in Q1 2016" width="890" height="526" class="aligncenter size-full wp-image-74667" /></a></p>
<p style="text-align:center;font-weight:bold"><em><b>The safest countries in terms of local infection</b> risks were the Czech Republic (27.2%), Denmark (23.2%) and Japan (21.0%).</em></p>
<p>An average of 44.5% of computers globally faced at least one local threat during Q1 2016, which is 0.8 p.p. more than in Q4 2015.</p>
]]></content:encoded>
			<wfw:commentRss>http://securelist.com/analysis/quarterly-malware-reports/74640/it-threat-evolution-in-q1-2016/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Petya: the two-in-one trojan</title>
		<link>http://securelist.com/blog/research/74609/petya-the-two-in-one-trojan/</link>
		<comments>http://securelist.com/blog/research/74609/petya-the-two-in-one-trojan/#respond</comments>
		<pubDate>Wed, 04 May 2016 10:39:32 +0000</pubDate>
		<dc:creator><![CDATA[Fedor Sinitsyn]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[Research]]></category>
		<category><![CDATA[Malware Descriptions]]></category>
		<category><![CDATA[Ransomware]]></category>

		<guid isPermaLink="false">https://kasperskycontenthub.com/securelist/?p=74609</guid>
		<description><![CDATA[Petya Trojan is an unusual hybrid of an MBR blocker and data encryptor: it prevents not only the operating system from booting but also blocks normal access to files located on the hard drives of the attacked system.]]></description>
				<content:encoded><![CDATA[<p><img width="400" height="280" src="http://securelist.com/wp-content/themes/securelist/images/article-default/abstraction_9.jpg" class="attachment-post-thumbnail wp-post-image no-image" alt="no-image"></p><p>Infecting the Master Boot Record (MBR) and encrypting files is nothing new in the world of malicious programs. Back in 1994, the virus <a href="https://en.wikipedia.org/wiki/OneHalf" target="_blank">OneHalf</a> emerged that infected MBRs and encrypted the disk contents. However, that virus did not extort money. In 2011, MBR blocker Trojans began spreading (Trojan-Ransom.Win32.Mbro) that infected the MBR and prevented the operating system from loading further. The victim was prompted to pay a ransom to get rid of the problem. It was easy to treat a system infected by these blocker Trojans because, apart from the MBR, they usually didn&#8217;t encrypt any data on the disk.</p>
<p>Today, we have encountered a new threat that&#8217;s a blast from the past. The Petya Trojan (detected by Kaspersky Lab products as Trojan-Ransom.Win32.Petr) infects the MBR preventing normal system loading, and encrypts the <a href="https://en.wikipedia.org/wiki/Master_File_Table" target="_blank">Master File Table</a> (MFT), an important part of the NT file system (NTFS), thus preventing normal access to files on the hard drive.</p>
<h2 id="the-infection-scenario">The infection scenario</h2>
<p>The people spreading Petya attack their potential victims by sending spam messages containing links that download a ZIP archive. The archive contains the Trojan&#8217;s executable file and a JPEG image. The file names are in German (Bewerbungsunterlagen.PDF.exe, Bewerbungsmappe-gepackt.exe), are made to look like resumes for job candidates, and target HR staff in German-speaking countries.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_1.jpg" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_1.jpg" alt="Petya: the two-in-one trojan" width="1002" height="428" class="aligncenter size-full wp-image-74614" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Contents of the archives downloaded from links in spam </em></p>
<p>The cybercriminals didn&#8217;t bother with automatic escalation of privileges – the manifest of the Trojan&#8217;s executable file contains the following standard record:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_2.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_2.png" alt="Petya: the two-in-one trojan" width="597" height="242" class="aligncenter size-full wp-image-74615" /></a></p>
<p>If the user launches the malicious executable file Petya, Windows will show the standard UAC request for privilege escalation. If the system has been properly configured by the system administrators (i.e. UAC is enabled, and the user is not working from an administrator account), the Trojan won&#8217;t be able to run any further.</p>
<p>Unfortunately, a user who has the privileges to agree to a UAC request often underestimates the potential risks associated with launching unknown software with elevated rights.</p>
<h2 id="how-it-works">How it works</h2>
<h3 id="the-executable-file-and-the-packer">The executable file and the packer</h3>
<p>A Petya Trojan infection begins with the launch of the malicious executable file. The samples of the Trojan that Kaspersky Lab received for analysis are, just like most other malware samples, protected with a customized packer. When the executable file launches, the malicious packer&#8217;s code begins to work – it unpacks the malicious DLL Setup.dll into a newly designated RAM area, and then passes control to it.</p>
<p>Cybercriminals typically use packers to avoid detection – circumvent static signatures, trick the heuristic analyzer, etc. While investigating the Petya packer, we noticed an unusual trick used by the cybercriminals.</p>
<p>Cybercriminals often try to create the packer in such a way that a packed malicious executable file looks as similar as possible to a regular legitimate file. Sometimes, they take a legitimate file and substitute part of the code with malicious code.  That&#8217;s what they did with Petya, with one interesting peculiarity: it was a part of the standard compiler-generated runtime DLL that was replaced with malicious code, while the function WinMain remained intact. The illustration below shows the transition, beginning from the entry point (&#8220;start&#8221;). As can be seen, the function of unpacking malicious code (which we dubbed &#8220;evil&#8221;) is called from the legal function __calloc_crt which is part of the runtime code.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_3.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_3.png" alt="Petya: the two-in-one trojan" width="857" height="454" class="aligncenter size-full wp-image-74616" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Diagram of transitions between the malicious packer&#8217;s functions</em></p>
<p>Why do it that way? Obviously, the creators of the malicious packer were trying to trick an inattentive researcher or automatic analyzers: the file looks legitimate – WinMain doesn&#8217;t contain malicious code – so it&#8217;s possible that it will be overlooked. Besides, if the breakpoint is set at WinMain during debugging, then the malicious code works (and sends the system into BSOD, as we will discuss later in detail) and execution is over before the breakpoint is even reached.</p>
<p>Kaspersky Lab has detected Petya samples that masquerade as legitimate files written in C/C++ and in Delphi.</p>
<h3 id="the-malicious-dll">The malicious DLL</h3>
<p>Setup.dll is a DLL with just one export: _ZuWQdweafdsg345312@0. It is written in C and compiled in Microsoft Visual Studio. The cybercriminals used an implementation of cryptographic algorithms available in the public library mbedtls (formerly polarssl). Setup.dll is not saved to the hard drive as a separate file, but always remains in the RAM.</p>
<p>When Setup.dll receives control, it decrypts the data contained in the section &#8216;.xxxx&#8217; and then proceeds to infect the victim computer.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_4.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_4-1024x496.png" alt="Petya: the two-in-one trojan" width="604" height="293" class="aligncenter size-large wp-image-74617" /></a></p>
<p style="text-align:center;font-weight:bold"><em>The encrypted &#8216;.xxxx&#8217; section containing data</em></p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_5.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_5.png" alt="Petya: the two-in-one trojan" width="648" height="830" class="aligncenter size-full wp-image-74618" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Fragment of the decrypted data from the &#8216;.xxxx&#8217; section</em></p>
<p>At a higher degree of abstraction, the actions of Setup.dll come down to the following:</p>
<ol>
<li>Re-write the boot record on the hard drive with its own malicious loader;</li>
<li>Generate a key, infection ID and other auxiliary information, and save them to the hard drive;</li>
<li>Cause a system abort and reboot, thereby passing control to the malicious loader.</li>
</ol>
<p>Now let&#8217;s look in detail at how all of this is implemented in the Trojan. But before doing so, we need to define the terminology used.</p>
<p><a href="https://en.wikipedia.org/wiki/Disk_sector" target="_blank">Hard disk sector</a> &#8211; the minimum addressable unit of a hard drive, typically 512 bytes.</p>
<p><a href="https://en.wikipedia.org/wiki/Master_boot_record" target="_blank">Master boot record</a> (MBR) &#8211; the code and the data written to Sector 0. After hardware is initialized, this code is used to boot the PC. Also, this sector contains the hard disks&#8217; partition table. A disk partitioned with MBR may have up to four primary partitions, and the maximum partition size is ~2.2 TB.</p>
<p><a href="https://en.wikipedia.org/wiki/GUID_Partition_Table" target="_blank">GUID Partition Table</a> (GPT) &#8211; a more modern standard of hard drive layout. It supports up to 128 partitions, each up to 9.4 ZB in size (1 ZB = 10<sup>21 </sup>bytes.)</p>
<p>Now let&#8217;s return to the Trojan under review. Setup.dll can infect disks partitioned according to either the older MBR standard or the more modern GPT standard. There are two alternative branches of execution sequences in the malicious program; the choice of execution branch depends on the data in the field PartitionStyle of the structure PARTITION_INFORMATION_EX.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_6.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_6.png" alt="Petya: the two-in-one trojan" width="919" height="666" class="aligncenter size-full wp-image-74619" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Selection of the execution branch for disk infection, depending on whether the disk has MBR or GPT partitioning</em></p>
<h4 id="infecting-an-mbr-disk">Infecting an MBR disk</h4>
<p>When infecting an MBR disk, Setup.dll performs the following actions:</p>
<ol>
<li>Encrypts sector 0 (the original code and the MBR data) with the simple operation XOR 0x37 (ASCII &#8216;7&#8217;), writes the result to sector 56;</li>
<li>Encrypts sectors 1-33 with the same operation XOR 0x37;</li>
<li>Generates configuration data for the malicious loader, writes them to sector 54;</li>
<li>Creates the <em>verification sector</em> 55 populated with the repeating byte 0x37;</li>
<li>Copies the disk&#8217;s NT signature and the partition table saved from the original MBR into its own first-level loader; writes first-level malicious code to sector 0 of the disk, and writes second-level code to sectors 34-50 (referred to here as the <em>malicious loader</em>);</li>
<li>Calls the function NtRaiseHardError, which causes the operating system to crash (BSOD &#8211; the &#8216;blue screen of death&#8217;).</li>
</ol>
<p>When an MBR disk has been infected, the beginning of the disk has the following structure:</p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Number of sector</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Content</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">0</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">First-level malicious loader</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">1 &#8211; 33</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Encrypted sectors 1-33 (XOR 0x37)</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">34 &#8211; 50</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Second-level malicious code</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">…</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">
	</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">54</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Configuration sector of the malicious program</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">55</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Verification sector (populated with byte 0x37)</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">56</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Encrypted original MBR code (XOR 0x37)</td>
</tr>
</table>
</div>
<h4 id="infecting-a-gpt-disk">Infecting a GPT disk</h4>
<p>When infecting a GPT disk, Setup.dll performs more actions:</p>
<ol>
<li>Based on Primary GPT Header data, it receives the address of GPT header copy;</li>
<li>Encrypts the GPT header copy with XOR 0x37;</li>
<li>Performs all the actions that are performed when encrypting an MBR disk.</li>
</ol>
<p>When a GPT disk has been infected, the beginning of the disk has the following structure:</p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Number of sector</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Content</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">0</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">First-level malicious loader</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">1 &#8211; 33</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Encrypted sectors 1-33 (XOR 0x37)</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">34 &#8211; 50</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Second-level malicious code</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">…</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">
	</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">54</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Configuration sector of the malicious program</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">55</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Verification sector (populated with byte 0x37)</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">56</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Encrypted original MBR code (XOR 0x37)</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">&#8230;</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px"></td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Backup LBA –<br />Backup LBA + 33</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Encrypted copy of GPT Header (XOR 0x37)</td>
</tr>
</table>
</div>
<h4 id="generation-of-configuration-data">Generation of configuration data</h4>
<p>In the configuration sector (sector 54), the Trojan keeps the data it needs to encrypt MFT and decrypt it if the victim pays the ransom. Generation of the configuration data consists of the following steps:</p>
<ol>
<li>Setup.dll generates a random string that is 16 characters long [1-9, a-x, A-X]; we will call this string <strong><span style="color: #002060">password</span></strong>;</li>
<li>Generate a pair of keys: <strong><span style="color: #00b0f0">ec_session_priv</span></strong> (a private key, a random large integer number) + <strong><span style="color: #00b0f0">ec_session_pub </span></strong>(public key, a point on a standard elliptic curve secp192k1);</li>
<li>Calculate the session secret: session_secret = ECDH (<strong><span style="color: #00b0f0">ec_session_priv</span></strong>, <strong><span style="color: #c00000">ec_master_pub</span></strong>); the cybercriminals&#8217; public key <strong><span style="color: #c00000">ec_master_pub </span></strong>is contained in the Trojan&#8217;s body;</li>
<li>Calculate the aes_key = SHA512(session_secret) – only the first 32 bytes of the hash sum are used;</li>
<li>Encrypt the &#8216;password&#8217; string by XORing it with the first 16 bytes of ec_session_pub: <strong> <span style="color: #002060">password_xor</span></strong> = <strong><span style="color: #00b0f0">ec_session_pub</span></strong>[0, 15] xor <strong><span style="color: #002060">password</span></strong>;</li>
<li>Encrypt the result using AES-256 with the key aes_key: <strong><span style="color: #002060">password_aes_encr</span></strong> = AES_enc(<strong><span style="color: #002060">password_xor</span></strong>);</li>
<li>Create the array ec_session_data = [<strong><span style="color: #00b0f0">ec_session_pub</span></strong>, <strong><span style="color: #002060">password_aes_encr</span></strong>];</li>
<li>Calculate base58: ec_session_data_b58 = base58_enc(ec_session_data);</li>
<li>Use the result to calculate SHA256: digest = sha256(ec_session_data_b58);</li>
<li>Create array: ec_data = [check1, check2, ec_session_data_b58], where check1, check2 are bytes calculated by the formulas:<br />
a = digest[0] &amp; 0xF;<br />
b = (digest[0] &amp; 0xF) &lt; 10;<br />
check1 = (digest[0] &gt;&gt; 4) + 0x57 + ((digest[0] &gt;&gt; 4) &lt; 10 ? 0xD9 : 0);<br />
check2 = a + 0x57 + (b ? 0xD9 : 0);</li>
<li>Based on the &#8216;password&#8217;, create a key for MFT encryption;</li>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_7.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_7.png" alt="Petya: the two-in-one trojan" width="397" height="129" class="aligncenter size-full wp-image-74620" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Pseudocode creating a key for MFT encryption</em></p>
<li>Generate IV – 8 random bytes which will be used during MFT encryption;</li>
<li>Generate infection ID and use it to create &#8220;personalized&#8221; URLs for ransom payment webpages.</li>
</ol>
<p>Ultimately, the configuration data structure looks like this:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_8.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_8.png" alt="Petya: the two-in-one trojan" width="483" height="114" class="aligncenter size-full wp-image-74621" /></a></p>
<p>In C language syntax, this structure can be presented as follows:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/9_eng_petya.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/9_eng_petya.png" alt="9_eng_petya" width="546" height="167" class="aligncenter size-full wp-image-74637" /></a></p>
<p>This is what the configuration data looks like after it is written to the hard drive:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_10.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_10.png" alt="Petya: the two-in-one trojan" width="612" height="384" class="aligncenter size-full wp-image-74623" /></a></p>
<p>Note that if the user turns off their computer after this stage and doesn&#8217;t switch it on again, only minimum damage will be done, as it is not difficult to decrypt data encrypted with 1-byte XOR. Therefore, a good piece of advice: if you launch an unknown file and your system suddenly crashes, showing a blue screen, you should switch off your computer and get help from a qualified specialist. The specialist should be able to identify a Petya infection and restore the disk sectors encrypted with XOR.</p>
<p>If, however, the computer was re-booted, then the Trojan&#8217;s third stage kicks in – the malicious code written to sectors 0 and 34–50.</p>
<h3 id="the-malicious-loader">The malicious loader</h3>
<p>After rebooting, the code in sector 0 (the first-level loader) gains control. It loads the main second-level malicious code from sectors 34–50 into the memory and passes control to it. This code, in turn, receives information about the hard drives available in the system, searches for the disk where the configuration is written, reads the configuration data from sector 54 and, depending on the value in the field &#8216;config.state&#8217;, begins encryption (if the value is 0) or asks the user to enter the decryption key that they have purchased (if the value is 1).</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_11.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_11-1024x656.png" alt="Petya: the two-in-one trojan" width="604" height="387" class="aligncenter size-large wp-image-74624" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Fragment of code implementing the Trojan&#8217;s logic</em></p>
<h4 id="encryption-of-mft">Encryption of MFT</h4>
<p>The master file table (MFT) is a data structure with information about every file and directory on a volume formatted into NTFS, the file system that is used in all modern versions of Windows. The table contains the service data required to find each file on the disk. It can be compared to a table of contents in a book that tells you on which page to find a chapter. Similarly, MFT indicates which logical cluster a file is located in.</p>
<p>It is namely this critical area that is attacked by Petya. If the value of &#8216;config.state&#8217; is equal to 0 during launch, it does the following:</p>
<ol>
<li>Displays a fake disk check message:</li>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_12.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_12.png" alt="Petya: the two-in-one trojan" width="720" height="400" class="aligncenter size-full wp-image-74625" /></a></p>
<li>Reads the key &#8216;config.salsa_key&#8217; from the configuration sector into a local array; sets this field to zero on the disk, sets &#8216;config.state&#8217; field at 1;</li>
<li>Encrypts the verification sector 55 with the stream cipher <a href="https://en.wikipedia.org/wiki/Salsa20" target="_blank">Salsa20</a>; this sector is populated beforehand with the byte 0x37 (see the section &#8216;Infecting an MBR disk&#8217; above);</li>
<li>Searches for each partition&#8217;s MFT on each connected hard drive;</li>
<li>Encrypts the MFT data with cipher Salsa20. Encryption is performed in parts of 8 sectors (i.e. the size of each part is 4 KB). A counter of the encrypted parts is kept in sector 57 of the first disk.</li>
<li>When encryption is over, it triggers a system reboot.</li>
</ol>
<p>After the reboot, Petya displays an animated image of a flashing red and white skull drawn in ACCII-art style.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_13.gif" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_13.gif" alt="Petya: the two-in-one trojan" width="750" height="417" class="aligncenter size-full wp-image-74626" /></a></p>
<p>If the user presses any key, the Trojan displays a text which tells the victim in no uncertain terms what has happened.</p>
<h4 id="ransom-demand-and-decryption">Ransom demand and decryption</h4>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_14.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_14.png" alt="Petya: the two-in-one trojan" width="720" height="400" class="aligncenter size-full wp-image-74627" /></a></p>
<p>On this screen Petya displays links to the ransom payment webpages located in the Tor network (the addresses are specified in config.mal_urls), and the &#8220;personal decryption code&#8221; which the victim has to enter at either of the above sites. In reality, this &#8220;code&#8221; is the content of the field &#8216;config.ec_data&#8217;, hyphenated every six characters.</p>
<p>So, how do the cybercriminals plan to decrypt MFT, and are they even capable of doing so?</p>
<p>The &#8216;Key:&#8217; field on this screen accepts a text string from the user. This string is checked for length (a 16-character long string is required), and then the Trojan uses it to calculate a 32-byte &#8216;salsa_key&#8217; (following the algorithm discussed above in the section &#8216;Generation of configuration data&#8217;). The Trojan then attempts to decrypt the <em>verification sector </em>55 with this key, and checks that the decrypted sector is completely populated with the byte 0x37. If it is, the key is considered correct, and Petya uses it to decrypt MFT. Then it decrypts all starting sectors encrypted with XOR 0x37, decrypts the original MBR and prompts the user to reboot the computer.</p>
<p>Thus, the correct string to be entered in the &#8216;Key:&#8217; field is that very same &#8216;<strong><span style="color: #002060">password</span></strong>&#8216; string that is generated in the first step when the configuration data is created.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_15.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_15.png" alt="Petya: the two-in-one trojan" width="720" height="14" class="aligncenter size-full wp-image-74628" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Screen message displayed after successful decryption</em></p>
<p>The question remains: how do the cybercriminals know this string so they can communicate it to a victim who has paid the ransom? No automatic communication with C&amp;C servers is established during the entire infection life cycle. The answer lies in the description of the algorithm for generating configuration data.</p>
<p>The victim is prompted to manually enter their &#8220;personal decryption code&#8221; ec_data on the ransom payment webpage. The cybercriminal can then perform the following actions:</p>
<ol>
<li>Decode base58: base58_dec(ec_session_data_b58) = ec_session_data = [<strong><span style="color: #00b0f0">ec_session_pub</span></strong>, <strong><span style="color: #002060">password_aes_encr</span></strong>]</li>
<li>Calculate session_secret = ECDH(<strong><span style="color: #00b0f0">ec_session_pub</span></strong>, <strong><span style="color: #c00000">ec_master_priv</span></strong>), in accordance with the <a href="https://en.wikipedia.org/wiki/Elliptic_curve_Diffie%E2%80%93Hellman" target="_blank">Elliptic curve Diffie–Hellman</a> properties, where <strong><span style="color: #c00000">ec_master_priv</span></strong> is a private key known to the Trojan&#8217;s creators only;</li>
<li>Calculate aes_key = SHA256(session_secret);</li>
<li>Decrypt AES-256: <strong><span style="color: #002060">password_xor</span></strong> = AES_dec(<strong><span style="color: #002060">password_encr</span></strong>);</li>
<li>Knowing <strong><span style="color: #00b0f0">ec_session_pub</span></strong>, calculate the original <strong><span style="color: #002060">password</span></strong> based on <strong><span style="color: #002060">password_xor</span></strong>.</li>
</ol>
<h3 id="the-ransom-payment-webpage">The ransom payment webpage</h3>
<p>When we visit the Tor site at the URL provided by the Trojan, we see a page that requires a CAPTCHA to be entered, after which the main ransom payment page is loaded. The design of the page immediately catches the eye, with its hammer and sickle and the word &#8216;ransomware&#8217; in pseudo-Cyrillic. It looks like a USSR parody along the lines of the game Red Alert.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_16.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_16-1024x901.png" alt="Petya: the two-in-one trojan" width="604" height="531" class="aligncenter size-large wp-image-74629" /></a></p>
<p>This page displays a countdown clock showing when the ransom price will be doubled, as well as regularly updated links to news and publications related to Petya.</p>
<p>When the &#8216;Start the decryption process&#8217; button is pressed, you end up on a page that asks you to enter the value of &#8216;ec_data&#8217;, which is now called &#8220;your identifier&#8221; rather than &#8220;your personal decryption code&#8221;. It looks like the cybercriminals still haven&#8217;t decided what to call this part.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_17.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_17-1024x601.png" alt="Petya: the two-in-one trojan" width="604" height="354" class="aligncenter size-large wp-image-74630" /></a></p>
<p>When the user enters this string, the site displays the amount of ransom in BTC, information on how to purchase bitcoins, and the address where the money should be sent.</p>
<p>As well as that, there are two other pages on the website: FAQ and Support.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_18.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_18-1024x817.png" alt="Petya: the two-in-one trojan" width="604" height="482" class="aligncenter size-large wp-image-74631" /></a></p>
<p style="text-align:center;font-weight:bold"><em>The FAQ page</em></p>
<p>The FAQ page is interesting in that it contains false information: in reality, RSA is not used by the Trojan in any way, at any stage of infection.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_19.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/petya_eng_19-1024x817.png" alt="Petya: the two-in-one trojan" width="604" height="482" class="aligncenter size-large wp-image-74632" /></a></p>
<p style="text-align:center;font-weight:bold"><em>The Support page</em></p>
<p>On the Support page, the user is given the option of sending a message to the cybercriminals. One phrase in particular stands out: &#8220;Please write your message in english, our russian speaking staff is not always available&#8221;. This implies that there is at least one person in the group who speaks Russian.</p>
<h2 id="geographic-distribution">Geographic distribution</h2>
<p>As we noted above, the spam messages target German-speaking victims. KSN statistics clearly show that Germany is the main target for the cybercriminals.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/map_1_en-1.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/map_1_en-1.png" alt="Petya: the two-in-one trojan" width="890" height="526" class="aligncenter size-full wp-image-74635" /></a></p>
<p><strong>TOP 5 countries attacked by Petya Trojan by the number of attacked users:</strong></p>
<div align="center" style="margin-bottom:15px">
<table border="0" width="80%">
<tr>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center"></td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Country</td>
<td style="border-top: 1px solid #BCD9DD;border-bottom: 2px solid #FF0000;text-align:center">Number of attacked users</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">1</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Germany</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">579</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">2</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">China</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">19</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">3</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">India</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">8</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">4</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Japan</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
</tr>
<tr>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:left;padding-left: 10px">Russian Federation</td>
<td style="border-bottom: 1px solid #BCD9DD;text-align:center">5</td>
</tr>
</table>
</div>
<h2 id="conclusion">Conclusion</h2>
<p>After analyzing the Petya Trojan, we discovered that it is an unusual hybrid of an MBR blocker and data encryptor: it prevents not only the operating system from booting but also blocks normal access to files located on the hard drives of the attacked system.</p>
<p>Although Petya is noticeably different from the majority of ransomware that has emerged in the recent years, it can hardly be described as a fundamentally new development.  The ideas behind the Trojan have been seen before in earlier malware; the creators of Petya have simply combined them all in a single creation. That said, it should be acknowledged that it requires a certain degree of technical skill to implement a low-level code to encrypt and decrypt data prior to OS booting.</p>
<p>Another interesting peculiarity about Petya is the pseudo-Soviet graphic design on the ransom payment website; the name of the Trojan also fits into the image of a &#8220;Russian Trojan&#8221; designed by cybercriminals. There is no certainty as to whether the Trojan&#8217;s creators originally come from Russia or other former Soviet states; however, the text on the payment page suggests there is at least one Russian speaker in the gang.</p>
<p>Kaspersky Lab&#8217;s products protect users from this threat: Petya&#8217;s executable files are detected with the verdict Trojan-Ransom.Win32.Petr; in addition, the behavior analyzer proactively detects even unknown versions of this Trojan with the verdict PDM:Trojan.Win32.Generic.</p>
<h2 id="p-s-how-to-decrypt-your-data-without-paying-the-ransom">P.S. How to decrypt your data without paying the ransom</h2>
<p>On April 8, some independent researchers reported that they had found a <a href="https://github.com/leo-stone/hack-petya" target="_blank">method</a> of restoring the <strong><span style="color: #002060">password </span></strong>without paying the ransom to the cybercriminals. The method is based on a genetic algorithm; with the 8-byte long IV (stored in configuration sector 54) and the content of the encrypted verification sector 55, you can calculate the value of the <strong><span style="color: #002060">password</span></strong> that generates the salsa key, which can then be used to decrypt the MFT.</p>
]]></content:encoded>
			<wfw:commentRss>http://securelist.com/blog/research/74609/petya-the-two-in-one-trojan/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Kaspersky DDoS Intelligence Report for Q1 2016</title>
		<link>http://securelist.com/analysis/quarterly-malware-reports/74550/kaspersky-ddos-intelligence-report-for-q1-2016/</link>
		<comments>http://securelist.com/analysis/quarterly-malware-reports/74550/kaspersky-ddos-intelligence-report-for-q1-2016/#comments</comments>
		<pubDate>Thu, 28 Apr 2016 10:57:00 +0000</pubDate>
		<dc:creator><![CDATA[Kaspersky Lab]]></dc:creator>
				<category><![CDATA[Analysis]]></category>
		<category><![CDATA[Featured]]></category>
		<category><![CDATA[Quarterly Malware Reports]]></category>
		<category><![CDATA[Botnets]]></category>
		<category><![CDATA[DDoS-attacks]]></category>

		<guid isPermaLink="false">https://kasperskycontenthub.com/securelist/?p=74550</guid>
		<description><![CDATA[In Q1, resources in 74 countries were targeted by DDoS attacks. China, the US and South Korea remained the leaders in terms of number of DDoS attacks and number of targets. The longest DDoS attack in Q1 2016 lasted for 197 hours (or 8.2 days).]]></description>
				<content:encoded><![CDATA[<p><img width="500" height="280" src="http://securelist.com/files/2015/08/ddos_intro.jpg" class="attachment-securelist-huge-promo size-securelist-huge-promo wp-post-image" alt="ddos_intro" /></p><h2 id="q1-events">Q1 events</h2>
<p>We have selected the events from the first quarter of 2016 that, in our view, illustrate the main trends in the field of DDoS attacks and the tools used to perform them.</p>
<h3 id="a-record-breaking-reflection-ddos-attack">A record-breaking reflection DDoS attack </h3>
<p>DDoS attacks using amplification/reflection techniques are still popular and allow cybercriminals to break their peak power records. From a technical point of view, amplification methods are nothing new in DDoS attacks, but cybercriminals are discovering new ways and resources to enhance the capacity of their botnets. For example, <a href="http://www.infosecurity-magazine.com/news/ddos-attacks-hit-record-500-gbps/" target="_blank">according to a recently published report</a>, 2015 saw the largest ever DDoS attack on record at 450-500 Gbps.</p>
<h3 id="ddos-attack-on-trump">DDoS attack on Trump</h3>
<p>It&#8217;s possible that last year&#8217;s record didn&#8217;t last very long – at the very beginning of the year the official website of Donald Trump&#8217;s election campaign were <a href="http://www.zdnet.com/article/attackers-targeting-bbc-donald-trump-amazon-web-services/" target="_blank">subjected to DDoS attacks</a> whose strength, according to unconfirmed sources, reached 602 Gbps. The hacktivist group New World Hacking claimed responsibility for both incidents.</p>
<h3 id="use-of-the-dnssec-protocol">Use of the DNSSEC protocol</h3>
<p>Criminals <a href="http://conferences2.sigcomm.org/imc/2014/papers/p449.pdf" target="_blank">are increasingly using</a> the DNSSEC protocol to carry out DDoS attacks. The protocol is intended to minimize DNS spoofing attacks, but besides the domain data a standard DNSSEC reply also contains additional authentication information. Thus, unlike a standard DNS reply of 512 bytes, the DNSSEC reply comes to about 4096 bytes. Attackers exploit this feature to perform amplification DDoS attacks. They usually use domains in the government zone .gov, because in the US such domains are required by law to maintain DNSSEC.</p>
<h3 id="pingback-attacks-on-wordpress">Pingback attacks on WordPress</h3>
<p>Web resources powered by the WordPress content management system (CMS) are <a href="https://blog.sucuri.net/2016/02/wordpress-sites-leveraged-in-ddos-campaigns.html" target="_blank">still popular with cybercriminals carrying out DDoS attacks.</a> Popular CMS-based resources often become targets of DDoS attacks exploiting the WordPress pingback function. The pingback function notifies the author of a post published on a WordPress site when someone else links to that post on another site running the same CMS. If the administrator of the site running WordPress has enabled the function, all links leading to the materials published on a site can perform a so-called pingback, i.e. send a special XML-RPC request to the original site. A huge number of pingback requests sent to the original site can cause a &#8220;denial of service&#8221;. This feature continues to attract the attention of cybercriminals and helps them perform DDoS attacks at the application level. </p>
<h3 id="linux-mint-hacking">Linux Mint hacking</h3>
<p>On 21 February 2016, the head of Linux Mint, Clement Lefebvre, <a href="http://blog.linuxmint.com/?p=2994" target="_blank">reported</a> that someone had managed to hack the project infrastructure including its official website and forum, and substituted the link to the legitimate ISO image of the Linux Mint 17.3 Cinnamon edition with their own URL. The hacker&#8217;s modified ISO contained malicious code that used infected machines to perform DDoS attacks.</p>
<h2 id="attacks-on-security-companies">Attacks on security companies</h2>
<p>Cybercriminals also target companies working in information security, with most of the major players – especially those offering anti-DDoS services – having to regularly combat DDoS attacks on their resources. These attacks can&#8217;t cause much damage because all these resources are well-protected, but that doesn&#8217;t stop the cybercriminals.</p>
<blockquote class="twitter-pullquote"><p>In Q1 2016, resources in 74 countries were targeted by #DDoS attacks #KLreport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74550%2Fkaspersky-ddos-intelligence-report-for-q1-2016%2F&#038;text=In+Q1+2016%2C+resources+in+74+countries+were+targeted+by+%23DDoS+attacks+%23KLreport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>In general, cybercriminals don&#8217;t go all out to bring down an IT security company&#8217;s site. The attacks tend not to last long, and in most cases, they are terminated as soon as the source notices that protection systems are working. The cybercriminals don&#8217;t want to waste their botnet resources when they could be earning money elsewhere. Nevertheless, the attacks continue.</p>
<p>Analysis of the correspondence on underground forums suggests that the criminal fraternity uses the websites of IT security companies as test bed, i.e. to test new methods and tools. This approach is no worse than others, but it does give us some valuable information. If worldwide DDoS statistics show the current state of things, then attacks on IT security companies allow us to some extent to predict the future of DDoS.</p>
<p>Data on the tactics, strength and types of attacks targeting Kaspersky Lab sites also allows us to forecast the trends in the DDoS industry for the coming months.</p>
<p>Once again, we have had to deal with amplification attacks. Their number has declined slightly compared to last year, but their maximum strength has increased fourfold. This confirms the trend of a general strengthening of these attacks – the criminals have to increase the strength to overcome protection measures used by Internet providers and information security companies. In our case, none of these attacks led to our sites being unavailable.</p>
<blockquote class="twitter-pullquote"><p>In Q1 2016, 93.6% of resources targeted by #DDoS attacks, were located in 10 countries #KLreport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74550%2Fkaspersky-ddos-intelligence-report-for-q1-2016%2F&#038;text=In+Q1+2016%2C+93.6%25+of+resources+targeted+by+%23DDoS+attacks%2C+were+located+in+10+countries+%23KLreport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>Considering the number of attacks on Kaspersky Lab resources in the first quarter of 2016, the &#8220;cream&#8221; of the cybercriminal community has gone back to the good old methods of attacks at the application level. Already in the first quarter of this year, we combated several times more HTTP(s) attacks than we did in the whole of 2015. Interestingly, there were several application-layer attacks performed simultaneously against a number of Kaspersky Lab resources. The strength of the DDoS resources was spread between several targets, reducing the effect on each target. This is most probably because the aim was not to disrupt Kaspersky Lab&#8217;s sites but to test tools and to see how we responded. The longest attack of this type lasted less than six hours.</p>
<p>We can assume that the proportion of Data Link layer attacks will gradually decline, and application-layer and multi-layer attacks (a combination of hardware and application-layer attacks) will come to the fore.</p>
<p>Powerful UDP amplification attacks came into general use a few years ago and are still a favorite tool of cybercriminals. The reasons for their popularity are clear: they are relatively easy to perform, they can be very powerful with a relatively small botnet, they often involve a third party, and it is extremely difficult to detect the source of the attack.</p>
<p>Although in Q1 of 2016 our Kaspersky DDoS Prevention service continued to combat UDP amplification attacks, we believe that they will gradually disappear. The once daunting task of combining the efforts of Internet providers and IT security companies to effectively filter the junk traffic generated by UDP attacks is almost solved. Having faced the risk of their main channels being clogged up due to large volumes of UDP packets, providers have acquired the necessary equipment and skills and cut this traffic off at the root. This means amplification attacks on a Data Link Layer are becoming less effective and, as a result, less profitable.</p>
<blockquote class="twitter-pullquote"><p>In Q1 2016, the largest numbers of #DDoS attacks targeted victims in #China, the #USA &amp; #SouthKorea #KLReport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74550%2Fkaspersky-ddos-intelligence-report-for-q1-2016%2F&#038;text=In+Q1+2016%2C+the+largest+numbers+of+%23DDoS+attacks+targeted+victims+in+%23China%2C+the+%23USA+%26amp%3B+%23SouthKorea+%23KLReport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>To execute application-layer attacks on web services, large botnets or several high-performance servers and a wide output channel are required, as well as thorough preparatory work to study the target and find its vulnerabilities. Without this, they are ineffective. If the application-layer attack is carried out properly, it is difficult to counter it without blocking access to legitimate users – malicious requests look authentic and every bot faithfully fulfills the connection procedure. The only anomaly is the high demand for the service. We registered these sorts of attempts in the first quarter. This suggests that the DDoS market has developed so that complex, expensive attacks are becoming cost-effective, and better qualified cybercriminals are trying to make money using them.</p>
<p>Moreover, there is a real danger of these methods being used by cybercriminals en masse – the more popular the technique, the more tools are offered for it on the black market. And if application-layer attacks really do become widespread, we should expect to see a growth in the number of customers for this type of DDoS attack and more competent attackers.</p>
<h2 id="statistics-for-botnet-assisted-ddos-attacks">Statistics for botnet-assisted DDoS attacks</h2>
<h3 id="methodology">Methodology</h3>
<p>Kaspersky Lab has extensive experience in combating cyber threats, including DDoS attacks of various types and levels of complexity. The company&#8217;s experts monitor botnet activity with the help of the DDoS Intelligence system.</p>
<p>The DDoS Intelligence system (part of <a href="http://www.kaspersky.com/business-security/ddos-protection" target="_blank">Kaspersky DDoS Protection</a>) is designed to intercept and analyze commands sent to bots from command and control (C&amp;C) servers, and does not have to wait until user devices are infected or cybercriminal commands are executed in order to gather data.</p>
<p>This report contains the DDoS Intelligence statistics for the first quarter of 2016.</p>
<p>In the context of this report, a single (separate) DDoS attack is defined as an incident during which any break in botnet activity lasts less than 24 hours. If the same web resource was attacked by the same botnet after a break of more than 24 hours, this is regarded as a separate DDoS attack. Attacks on the same web resource from two different botnets are also regarded as separate attacks.</p>
<blockquote class="twitter-pullquote"><p>The longest #DDoS attack in Q1 2016 lasted for 197 hours (or 8.2 days) #KLreport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74550%2Fkaspersky-ddos-intelligence-report-for-q1-2016%2F&#038;text=The+longest+%23DDoS+attack+in+Q1+2016+lasted+for+197+hours+%28or+8.2+days%29+%23KLreport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>The geographic distribution of DDoS victims and C&amp;C servers is determined according to their IP addresses. In this report, the number of DDoS targets is calculated based on the number of unique IP addresses reported in the quarterly statistics.</p>
<p>It is important to note that DDoS Intelligence statistics are limited to those botnets that were detected and analyzed by Kaspersky Lab. It should also be highlighted that botnets are just one of the tools used to carry out DDoS attacks; therefore, the data presented in this report does not cover every DDoS attack that has occurred within the specified time period.</p>
<h3 id="q1-summary">Q1 Summary</h3>
<ul>
<li>In Q1, resources in 74 countries were targeted by DDoS attacks (vs. 69 in Q4 of 2015).</li>
<li>93.6% of the targeted resources were located in 10 countries.</li>
<li>China, the US and South Korea remained the leaders in terms of number of DDoS attacks and number of targets. France and Germany were newcomers to the Top 10. </li>
<li>The longest DDoS attack in Q1 2016 lasted for 197 hours (or 8.2 days) which is far less than the previous quarter&#8217;s maximum (13.9 days). Multiple attacks on the same target became more frequent (up to 33 attacks on one resource during the reporting period).</li>
<li>SYN DDoS, TCP DDoS and HTTP DDoS remain the most common DDoS attack scenarios, while the number of UDP attacks continues to fall from quarter to quarter.</li>
<li>Overall, command servers remained located in the same countries as the previous quarter, but Europe&#8217;s contribution increased – the number of C&amp;C servers in the UK and France grew noticeably. </li>
</ul>
<h3 id="geography-of-attacks">Geography of attacks</h3>
<p>In Q1 2016, the geography of DDoS attacks narrowed to 74 countries. </p>
<p>93.6% of targeted resources were located in 10 countries.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_1.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_1-1024x708.png" alt="Kaspersky DDoS Intelligence Report for Q1 2016" width="604" height="418" class="aligncenter size-large wp-image-74553" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of DDoS attacks by country, Q1 2016 vs. Q4 2015</em></p>
<p>The Top 3 most targeted countries remained unchanged. However, South Korea&#8217;s share grew from 18.4% to 20.4% while the US&#8217;s contribution dropped by 2.2 percentage points. Also of note is the fact that Q1 2016 saw an increase in the number of attacks targeting resources in Ukraine – from 0.3% to 2.0%.</p>
<p>The statistics show that 94.7% of all attacks had targets within the Top 10 most targeted countries:</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_2.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_2-1024x700.png" alt="Kaspersky DDoS Intelligence Report for Q1 2016" width="604" height="413" class="aligncenter size-large wp-image-74554" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of unique DDoS attack targets by country,</em> <em>Q1 2016 vs. Q4 2015</em></p>
<p>The number of targets in South Korea increased by 3.4 percentage points. China&#8217;s share fell from 50.3% in Q4 2015 to 49.7% in the first three months of 2016. The percentage of DDoS attacks targeting resources in the United States also decreased (9.6% in Q1 2016 vs. 12.8% in Q4 2016). Despite the change in figures, South Korea, China and the US maintained their positions in the Top 3, coming well ahead of all other countries.</p>
<blockquote class="twitter-pullquote"><p>SYN #DDoS, TCP DDoS &amp; HTTP DDoS remain the most common DDoS attack scenarios in Q1 2016 #KLreport</p><a href="https://twitter.com/share?url=http%3A%2F%2Fsecurelist.com%2Fanalysis%2Fquarterly-malware-reports%2F74550%2Fkaspersky-ddos-intelligence-report-for-q1-2016%2F&#038;text=SYN+%23DDoS%2C+TCP+DDoS+%26amp%3B+HTTP+DDoS+remain+the+most+common+DDoS+attack+scenarios+in+Q1+2016+%23KLreport" class="btn btn-twhite" data-lang="en" data-count="0">Tweet</a></blockquote>
<p>The first quarter of 2016 saw Ukraine enter the Top 5 DDoS targets: its share grew from an insignificant 0.5% at the end of last year to 1.9% in Q1 2016.</p>
<p>Taiwan and the Netherlands&#8217; share fell 0.8 and 0.7 percentage points respectively, meaning both dropped out of the Top 10 most attacked countries.</p>
<h3 id="changes-in-ddos-attack-numbers">Changes in DDoS attack numbers</h3>
<p>In Q1 2016, DDoS activity was distributed more or less evenly, with the exception of one peak on 6 February. The peak number of attacks in one day was 1,272, recorded on 31 March.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_3.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_3-1024x460.png" alt="Kaspersky DDoS Intelligence Report for Q1 2016" width="604" height="271" class="aligncenter size-large wp-image-74555" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Number of DDoS attacks over time* in Q1 2016.</em></p>
<p><em><small>* DDoS attacks may last for several days. In this timeline, the same attack can be counted several times, i.e. one time for each day of its duration.</small></em></p>
<p>As in the previous quarter, Monday (16.5% of attacks) was the most active day of the week for DDoS attacks. Thursday moved up to second (16.2%). Tuesday, which was in second place in Q4 2015 (from 16.4% to 13.4%), became the quietest day of the week in terms of DDoS attacks.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_4.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_4-1024x470.png" alt="Kaspersky DDoS Intelligence Report for Q1 2016" width="604" height="277" class="aligncenter size-large wp-image-74556" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of DDoS attack numbers by day of the week</em></p>
<h3 id="types-and-duration-of-ddos-attacks">Types and duration of DDoS attacks</h3>
<p>The ranking of the most popular attack methods remained constant from quarter to quarter. Those used most often were the SYN DDoS method, although its share fell compared to the previous quarter (57.0% vs 54.9%), and TCP DDoS which fell by 0.7 percentage point. The proportion of ICMP DDoS attacks grew significantly, rising to 9%; however, it did not affect the order of the Top 5.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_5.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_5-1024x602.png" alt="Kaspersky DDoS Intelligence Report for Q1 2016" width="604" height="355" class="aligncenter size-large wp-image-74557" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of DDoS attacks by type</em></p>
<p>Noticeably, the figure for UDP DDoS has fallen continually over the last year: from 11.1% in Q2 2015 to 1.5% in Q1 2016.</p>
<p>Like the previous quarter, about 70% of attacks lasted no more than 4 hours. At the same time, the maximum duration of attacks decreased considerably. The longest DDoS attack in the last quarter of 2015 lasted for 333 hours; in Q1 2016, the longest registered attack ended after 197 hours.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_6.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_6-1024x588.png" alt="Kaspersky DDoS Intelligence Report for Q1 2016" width="604" height="347" class="aligncenter size-large wp-image-74558" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of DDoS attacks by duration (hours)</em></p>
<h3 id="cc-servers-and-botnet-types">C&amp;C servers and botnet types</h3>
<p>In Q1, South Korea remained the leader in terms of the number of C&amp;C servers located on its territory, with its share growing from 59% in the previous quarter to 67.7% in the first quarter of 2016.</p>
<p>China came second; its share grew from 8.3% to 9.5%. As a result, China pushed the US down to third (6.8% vs 11.5% in Q4 of 2015). For the first time during the reporting period France appeared in the Top 10 countries hosting the most C&amp;C servers. This correlates with the increased number of attacks in the country.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_7.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_7-1024x836.png" alt="Kaspersky DDoS Intelligence Report for Q1 2016" width="604" height="493" class="aligncenter size-large wp-image-74559" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Distribution of botnet C&amp;C servers by country in Q1 2016</em></p>
<p>99.73% of DDoS targets in Q1 2016 were attacked by bots belonging to one family. Cybercriminals launched attacks using bots from two different families (used by one or more botnet masters) in just 0.25% of cases. In 0.01% of cases three or more bots were used, mainly from the Sotdas, Xor and BillGates families.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_8.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/ddos_2016_q1_en_8-1024x615.png" alt="Kaspersky DDoS Intelligence Report for Q1 2016" width="604" height="363" class="aligncenter size-large wp-image-74561" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Correlation between attacks launched from Windows and Linux botnets</em></p>
<p>When it came to the number of attacks launched from Windows and Linux botnets in Q1 2016, Windows-based botnets were the clear leader. For the third quarter in a row, the difference between the share of Windows- and Linux-based attacks was approximately 10 percentage points.</p>
<h2 id="conclusion">Conclusion</h2>
<p>The events of the first quarter of 2016 once again demonstrated that the attackers are not resting on their laurels and are increasing their computing resources to perform DDoS attacks. Amplification scenarios, which have de facto become the standard tool for carrying out a powerful attack, exploit vulnerabilities in new network protocols. The reasons for an attack can vary: from disrupting pre-election campaigns and attacking candidates&#8217; resources to showdowns between competitors on the black market. There have been frequent incidents of DDoS attacks targeting the very organizations that specialize in countering them. With the spread of vulnerable devices and workstations and the abundance of configuration drawbacks at the application level, the cost of a significant attack is going down. Therefore, reliable protection is needed to ensure these attacks are financially unviable for the criminals.</p>
]]></content:encoded>
			<wfw:commentRss>http://securelist.com/analysis/quarterly-malware-reports/74550/kaspersky-ddos-intelligence-report-for-q1-2016/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Contributing to the Annual DBIR</title>
		<link>http://securelist.com/blog/74586/contributing-to-the-annual-dbir/</link>
		<comments>http://securelist.com/blog/74586/contributing-to-the-annual-dbir/#respond</comments>
		<pubDate>Wed, 27 Apr 2016 16:27:30 +0000</pubDate>
		<dc:creator><![CDATA[GReAT]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[News]]></category>
		<category><![CDATA[Cyber espionage]]></category>
		<category><![CDATA[Cybercrime]]></category>
		<category><![CDATA[DBIR APT]]></category>
		<category><![CDATA[Targeted Attacks]]></category>
		<category><![CDATA[Vulnerabilities and exploits]]></category>
		<category><![CDATA[Website Hacks]]></category>

		<guid isPermaLink="false">https://kasperskycontenthub.com/securelist/?p=74586</guid>
		<description><![CDATA[Our contributions on targeted attack activity and other areas to a report like this one over the past several years is important to help to improve cyber-security awareness and education both in the security industry and the general public.]]></description>
				<content:encoded><![CDATA[<p><img width="400" height="280" src="http://securelist.com/wp-content/themes/securelist/images/article-default/abstraction_3.jpg" class="attachment-post-thumbnail wp-post-image no-image" alt="no-image"></p><p>This year&#8217;s <a href="http://www.verizonenterprise.com/verizon-insights-lab/dbir/2016/" target="_blank">DBIR release</a> from Verizon exposes valuable and well organized data on global incidents this past year. Our contributions on targeted attack activity and other areas to a report like this one over the past several years is important to help to improve cyber-security awareness and education both in the security industry and the general public.</p>
<p style="text-align: center"><a href="https://kasperskycontenthub.com/securelist/blog/news/74586/contributing-to-the-annual-dbir/attachment/pyramideye/" target="_blank" rel="attachment wp-att-74587"><img class="aligncenter size-medium wp-image-74587" src="https://kasperskycontenthub.com/securelist/files/2016/04/PyramidEye-300x300.png" alt="PyramidEye" width="300" height="300" /></a></p>
<p style="text-align: left">The report is well organized, offering trending information from Point of Sale incidents to cyber-espionage, web application hacking, cybercrime, and skimming. And it simplifies most of the data into nine categories for ease of discussion. The data demonstrates that intruders will use tried and true techniques before moving on to the newest and most expensive. Like most years in cybersecurity, &#8220;It&#8217;s like déjà vu, all over again.&#8221; —Yogi Berra</p>
<p style="text-align: center"><a href="https://kasperskycontenthub.com/securelist/blog/news/74586/contributing-to-the-annual-dbir/attachment/title/" target="_blank" rel="attachment wp-att-74588"><img class="aligncenter size-medium wp-image-74588" src="https://kasperskycontenthub.com/securelist/files/2016/04/Title-300x268.png" alt="Title" width="300" height="268" /></a></p>
<p style="text-align: left">You can download the 2016 DBIR <a href="http://www.verizonenterprise.com/verizon-insights-lab/dbir/2016/" target="_blank">here</a>, its 85 pages of data and diagrams can help provide informed discussion around these topics on a greater scale. We look forward to another great writeup in 2017 from the DBIR guys at Verizon.</p>
]]></content:encoded>
			<wfw:commentRss>http://securelist.com/blog/74586/contributing-to-the-annual-dbir/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Freezer Paper around Free Meat</title>
		<link>http://securelist.com/blog/software/74503/freezer-paper-around-free-meat/</link>
		<comments>http://securelist.com/blog/software/74503/freezer-paper-around-free-meat/#respond</comments>
		<pubDate>Wed, 27 Apr 2016 11:20:49 +0000</pubDate>
		<dc:creator><![CDATA[GReAT]]></dc:creator>
				<category><![CDATA[Blog]]></category>
		<category><![CDATA[Incidents]]></category>
		<category><![CDATA[Research]]></category>
		<category><![CDATA[Software]]></category>
		<category><![CDATA[APT]]></category>
		<category><![CDATA[Cyber espionage]]></category>
		<category><![CDATA[Cybercrime]]></category>
		<category><![CDATA[Targeted Attacks]]></category>
		<category><![CDATA[Vulnerabilities and exploits]]></category>
		<category><![CDATA[Website Hacks]]></category>

		<guid isPermaLink="false">https://kasperskycontenthub.com/securelist/?p=74503</guid>
		<description><![CDATA[Instead of developing customized hacking tools or buying them from third-party suppliers on the criminal underground, cyberespionage threat actors are using tools available on the web for research purposes. Several cyberespionage campaigns utilizing such tools have been spotted recently by experts.]]></description>
				<content:encoded><![CDATA[<p><img width="400" height="280" src="http://securelist.com/wp-content/themes/securelist/images/article-default/abstraction_3.jpg" class="attachment-post-thumbnail wp-post-image no-image" alt="no-image"></p><p><strong>BeEF Wrapped Up and Delivered in 2016</strong></p>
<p><span style="font-weight: 400">In late February 2016, a University website in Iran stood out for thoroughly vetting its current and potential students and staff. The University&#8217;s web site served repackaged content from the </span><a href="http://beefproject.com/"><span style="font-weight: 400">Browser Exploitation Framework</span></a><span style="font-weight: 400"> (BeEF) with embedded JavaScript content maintaining the potential to hook visitors&#8217; web browsers, identify visited websites and domains, explore for vulnerabilities (we did not observe any auto-pwning), and provide tracking through evercookies. Even a partial listing of visited sites can be sensitive and valuable information, and this sort of &#8220;sites visited&#8221; data gathering via other techniques, like screengrabbing and keylogging, were observed in past APT incidents like the </span><a href="https://securelist.com/blog/incidents/33693/the-madi-campaign-part-i-5/"><span style="font-weight: 400">Madi</span></a> <a href="https://securelist.com/blog/incidents/33701/the-madi-campaign-part-ii-53/"><span style="font-weight: 400">campaigns</span></a><span style="font-weight: 400">. Currently, it&#8217;s advisable to avoid the site</span><span style="font-weight: 400">.</span></p>
<p style="text-align: center"><a href="https://kasperskycontenthub.com/securelist/blog/software/74503/freezer-paper-around-free-meat/attachment/kheradact/" target="_blank" rel="attachment wp-att-74576"><img class="aligncenter wp-image-74576 size-medium" style="border: 1px solid black" src="https://kasperskycontenthub.com/securelist/files/2016/04/kheradact-300x116.png" width="300" height="116" /></a></p>
<p>The embedded BeEF content appears not to be fully configured, and only partially implemented. Perhaps a limited data set was of interest for this attacker, or this was an early attempt at deploying BeEF.</p>
<p>This incident is interesting because at the same time and a bit earlier, another group was heavily relying on repackaging open source offensive security product in their toolset by deploying both BeEF and Metasploit-produced components across a select set of strategic web compromises. This particular APT has years of low-tech elaborate social engineering schemes and re-purposed open source efforts under its belt.</p>
<p><a href="https://kasperskycontenthub.com/securelist/blog/software/74503/freezer-paper-around-free-meat/attachment/activebeef/" target="_blank" rel="attachment wp-att-74505"><img class="aligncenter wp-image-74505 size-medium" style="border: 1px solid black" src="https://kasperskycontenthub.com/securelist/files/2016/04/activeBeEF-300x142.png" alt="Active BeEF Project" width="300" height="142" /></a></p>
<p><span style="font-weight: 400">While we call them the NewsBeef APT, they have been reported in the past as Charming Kitten or Newscaster in 2014, social engineering their way into sensitive circles of trust with spoofed LinkedIn profiles and phony news media organizations.</span></p>
<p><span style="font-weight: 400">They continue to be highly active, but this time, they are using a slightly more technical toolset. On one hand, they have developed skills or discovered tools to compromise select web applications and sites, supporting their watering hole campaigns. On the other hand, they have repackaged leaked bot source code and repackaged open source Metasploit and PowerSploit components to produce and administer backdoors and downloaders.</span></p>
<p>Newsbeef/Newscaster will find a way to compromise a web site, usually the vulnerability appears to be CMS related, in an outdated WordPress plugin, Joomla version, or Drupal version. Attackers usually perform one of two things, Newsbeef has been performing the first of the two:</p>
<ul>
<li>inject a src or iframe link into web pages or css sheets</li>
<li>inject the content of an entire BeEF web page into one of the internally linked javascript helpers</li>
</ul>
<p>The injected link will redirect visitors&#8217; browsers to a BeEF server. Usually, the attackers deliver some of the tracking and system/browser identification and evercookie capabilities. Sometimes, it appears that they deliver the metasploit integration to exploit and deliver backdoors (we haven&#8217;t identified that exploitation activity in our ksn data related to this group just yet). Sometimes, it is used to pop up spoofed login input fields to steal social networking site credentials. We also haven&#8217;t detected that in ksn, but some partners have privately reported it about various incidents. But we have identified that attackers will redirect specific targets to laced Adobe Flash and other installers from websites that they operate.</p>
<p>So, the watering hole activity isn&#8217;t always and usually isn&#8217;t delivering backdoors. Most of the time, the watering hole injections are used to identify and track visitors or steal their browser history. Then, they deliver the backdoors to the right targets.</p>
<p>In addition to the University site and the NewsBeef APT, in the past couple of months, we identified a variety of compromised sites around the world serving the BeEF. Most are cleaned up. Deployments to interesting and strategic web sites and their true reach on a global scale appears to be on the increase:</p>
<ul>
<li>Middle eastern embassy in the Russian Federation</li>
<li>Indian military technology school</li>
<li>High conflict regional presidency</li>
<li>Ukrainian ICS Scanner mirror</li>
<li>European Union education diversification support agency</li>
<li>Russian foreign trade management organization</li>
<li>Progressive Kazakh news and politics media</li>
<li>Turkish news organization</li>
<li>Specialized German music school</li>
<li>Japanese textile manufacturing inspection corporate division</li>
<li>Middle Eastern social responsibility and philanthropy</li>
<li>surprisingly popular British &#8220;lifestyle&#8221; blog</li>
<li>Algerian University&#8217;s online course platform</li>
<li>Chinese construction group</li>
<li>Russian overseas business development and holding company</li>
<li>Russian gaming developer forum</li>
<li>Romanian Steam gaming developer</li>
<li>Chinese online gaming virtual gold seller</li>
<li>Brazilian music instrument retailer</li>
</ul>
<p>&nbsp;</p>
<p><strong>BeEF Capabilities</strong></p>
<p>Key to these incidents are the development, distribution, and ease of use of toolkits like BeEF.</p>
<p><a href="https://kasperskycontenthub.com/securelist/blog/software/74503/freezer-paper-around-free-meat/attachment/r_bfast/" target="_blank" rel="attachment wp-att-74513"><img class="aligncenter wp-image-74513" style="border: 1px solid black" src="https://kasperskycontenthub.com/securelist/files/2016/04/r_bfast-300x205.png" alt="Cut of BeEF" width="160" height="109" /></a></p>
<p>BeEF itself is an open source collection of tools and tricks, some years old, that combined together can effectively hook a visiting web browser for evaluation and full exploitation. Because of its capabilities, we have seen increased adoption of the framework for the past year or so.</p>
<ul>
<li>Browser enumeration and reporting</li>
<li>Plugin enumeration and reporting</li>
<li>Retrieve visited domains (based on an old browser cache fetch timing trick)</li>
<li>Social engineering via live sessions and phishing within the browser</li>
<li>Network exploration, discovery, and exfiltration tunneling</li>
<li>Metasploit exploit integration and autopwning</li>
<li>Evercookie deployment for persistent tracking &#8211; multiple platforms</li>
<li>XSS evaluation and exploitation</li>
</ul>
<p>At the same time, many of the techniques implemented are very old and public. The kit is extensible, customizable, and integrates with metasploit for autopwnage. Some of the techniques were discussed during <a href="http://jeremiahgrossman.blogspot.com/2006/08/i-know-where-youve-been.html">Jeremiah Grossman&#8217;s 2006 Black Hat conference presentation</a>. The delay in deployment for techniques of this type indicates that some teams are dependent on open source tool packaging and ease of use. We have seen this sort of reliance on both open source offensive toolkits and legitimate software in the past from APT like <a href="https://securelist.com/blog/research/65240/energetic-bear-more-like-a-crouching-yeti/">Crouching Yeti</a>, <a href="https://securelist.com/blog/incidents/35520/the-teamspy-crew-attacks-abusing-teamviewer-for-cyberespionage-8/">TeamSpy</a>, and now the Newsbeef.</p>
<p>Fighting against the use of browser hooking frameworks for identification, tracking, live session social engineering, and precision and auto-exploitation effectively requires a mix of technologies. When these JavaScript-based frameworks are used in a malicious manner, the combination of network and host based detection is required to fully handle more serious incidents.</p>
<p>Unfortunately, these incidents are on the increase. You can disable JavaScript in your own browser with NoScript, but that&#8217;s much like just moving to Lynx or a text-based browser &#8211; people don&#8217;t want that because it kills functionality in the browser they do want. A Chrome plugin that detects the BeEF cookie is easily evaded by serious players. And preventing the tracking methods altogether is another whole ball of wax, because much of the functionality is tied into legitimate web pages by third party marketers and retailers.</p>
<p>Preventing the social engineering sessions for credential theft and Metasploit exploit integration makes immediate sense and can be incorporated at the network and more effectively at the host level. AntiAPT can help wipe out most of an operation on the network at scale, but these measures can be evaded as well. In other words, dealing with a determined attacker using tools like this one is difficult.</p>
<p><strong>References</strong></p>
<p><a href="http://www.isightpartners.com/2014/05/newscaster-iranian-threat-inside-social-media/">NEWSCASTER – An Iranian Threat Inside Social Media</a><br />
<a href="http://beefproject.com">The Browser Exploitation Framework Project</a><br />
<a href="https://www.metasploit.com/">Metasploit: Penetration Testing Software</a></p>
<p><a href="https://kas.pr/APT_reporting_SL_text_button" target="_blank"><img class="aligncenter size-full wp-image-73094" src="https://securelist.com/files/2015/11/640x60_apt_subscribe_banner.png" alt="Subscribe now For Kaspersky Lab's APT Intelligence Reports" width="640" height="60" /></a></p>
]]></content:encoded>
			<wfw:commentRss>http://securelist.com/blog/software/74503/freezer-paper-around-free-meat/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Malware and non-malware ways for ATM jackpotting. Extended cut</title>
		<link>http://securelist.com/analysis/publications/74533/malware-and-non-malware-ways-for-atm-jackpotting-extended-cut/</link>
		<comments>http://securelist.com/analysis/publications/74533/malware-and-non-malware-ways-for-atm-jackpotting-extended-cut/#comments</comments>
		<pubDate>Tue, 26 Apr 2016 11:02:30 +0000</pubDate>
		<dc:creator><![CDATA[Olga Kochetova]]></dc:creator>
				<category><![CDATA[Analysis]]></category>
		<category><![CDATA[Featured]]></category>
		<category><![CDATA[Publications]]></category>
		<category><![CDATA[ATM]]></category>
		<category><![CDATA[ATM attacks]]></category>
		<category><![CDATA[Cybercrime]]></category>

		<guid isPermaLink="false">https://kasperskycontenthub.com/securelist/?p=74533</guid>
		<description><![CDATA[Millions of people around the world now use ATMs every day to withdraw cash, pay in to their account or make a variety of payments. Unfortunately, ATM manufacturers and their primary customers – banks – don’t pay much attention to the security of cash machines. ]]></description>
				<content:encoded><![CDATA[<p><img width="500" height="361" src="http://securelist.com/files/2016/04/atm_pr.jpg" class="attachment-securelist-huge-promo size-securelist-huge-promo wp-post-image" alt="atm_pr" /></p><p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/jackpot_pre.jpg" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/jackpot_pre.jpg" alt="Malware and non-malware ways for ATM jackpotting. Extended cut" width="1000" height="722" class="aligncenter size-full wp-image-74569" /></a></p>
<p>Cash machines have been part of our lives since 1967 when a London branch of Barclays Bank unveiled the first ATM. Millions of people around the world now use ATMs every day to withdraw cash, pay in to their account or make a variety of payments. When using ATMs people give little or no thought to the hardware, software or security of the machines. Unfortunately, ATM manufacturers and their primary customers – banks – don&#8217;t pay much attention to the security of cash machines either. This is confirmed by the increasing number of thefts from ATMs using non-destructive methods, i.e. without the use of metal cutting tools or explosives.</p>
<p>To understand why this is happening, let&#8217;s first look at what exactly a cash machine is.</p>
<h2 id="hardware">Hardware</h2>
<p>An ATM is basically a construction kit. The manufacturer builds them from a dispenser, a card reader and other units produced by different companies. The units are placed in a housing which usually consists of two parts: the top box called the cabinet, or the servicezone, and the lower section called thesafe.</p>
<p>The cabinet includes units such as the system unit (yes, a standard system unit, which sometimes even has the same housing as a typical home computer), the EPP (Encrypting PIN Pad) the card reader, and so on. The service zone, according to ATM manufacturers, contains everything that makes it impossible to access the money. Probably for this reason the cabinet cover is made of plastic and the service zone is protected from unauthorized access by just a simple lock. By the way, a set of locks and separate keys can both easily be purchased online as the manufacturers install the same locks on their devices, and most banks usually don&#8217;t bother to replace them.</p>
<p>The safe has much better protection: it is a &#8216;sandwich&#8217; of steel and concrete with two types of locks &#8211; one coded (electronic or limb, sometimes electro-mechanical) and the other a key lock (usually a lever tumbler lock). The safe contains the devices directly related to the money – a dispenser from which cash is withdrawn, and a cash-in module.</p>
<p>All devices are connected to the system unit, which in this case performs the function of the host (as we shall refer to it) via the USB or RS232 ports (often referred to as a COM port). Sometimes these ports are located directly on the system unit; if there aren&#8217;t enough ports, a USB/COM hub is used. Older ATM models can still be found that are connected via the SDC bus.</p>
<h2 id="software">Software</h2>
<p>The software used on almost every ATM is straightforward:</p>
<ul>
<li>operating system</li>
<li>ATM units management software</li>
<li>software used to interact with the user (ATM consumer or operator)</li>
<li>software used to communicate with the processing center (which provides the information and technological sides of the transaction)</li>
<li>anti-virus software, or integrity control software.</li>
</ul>
<p>This is sufficient for the ATM to carry out its immediate functions, but for some reason certain banks also install Acrobat Reader 6.0, Radmin, TeamViewer and other unnecessary and in some cases even dangerous software.</p>
<p>When it comes to the operating system, the vast majority of ATMs still use &#8230; Windows XP! Despite the fact that Microsoft stopped issuing security updates for it in April 2014. Of course, 0-day vulnerabilities for this system will remain unpatched. The engineers servicing ATMs often think that if the ATM is working, it is better &#8220;not to touch&#8221; (read: &#8220;not to update&#8221;) it. As a consequence, some cash machines still have the unpatched critical vulnerability <a href="https://technet.microsoft.com/en-us/library/security/ms08-067.aspx" target="_blank">MS08-067</a> which allows remote code execution.</p>
<p>ATM units are implemented on microcontrollers based on real-time operating systems (RTOS), which is particularly irksome for the guys with <a href="https://en.wikipedia.org/wiki/Interactive_Disassembler" target="_blank">IDA Pro</a> because static analysis is almost unheard for such systems.</p>
<p>That&#8217;s basically all the information cybercriminals need to start hacking.</p>
<h2 id="malware">Malware</h2>
<p>In 2009, the appearance of <a href="https://securelist.com/analysis/kaspersky-security-bulletin/36283/kaspersky-security-bulletin-2009-malware-evolution-2009/" target="_blank">Trojan Backdoor.Win32.Skimer</a> caught the world&#8217;s attention: it was the first malicious program targeting ATMs. Skimer attacked ATMs from a particular manufacturer – one of the market leaders. Using this malicious program the criminals emptied the cash dispensers and also skimmed the data from bank cards processed in infected ATMs. Since then, ATMs of different manufacturers have been repeatedly exposed to malware infection.</p>
<p>The process of stealing money from ATMs using malware consists of four stages:</p>
<ul>
<li>The attacker gains local/remote access to the machine.</li>
<li>Malicious code is injected into the ATM system.</li>
<li>As a rule, infection is followed by rebooting of the ATM. The system seems to reboot in standard mode but at the same time comes under the control of a malicious program, i.e. cybercriminals.</li>
<li>The final stage, i.e. the main aim of the process, is the theft of money.</li>
</ul>
<p><a href="https://www.youtube.com/watch?v=KijIzHUtLjU&amp;feature=youtu.be" target="_blank">Getting access to the inside of an ATM</a> is not a particularly difficult task, as the experts at the Positive Hack Days, the international forum on practical information security, demonstrated. The process of infecting is also fairly clear – arbitrary code can be executed on an insecure (or insufficiently secure) system. There seems to be no problem with withdrawing money either – the malware interface is usually opened by using a specific key combination on the PIN pad or by inserting a &#8220;special card&#8221;, and then all you need to do is stuff your pockets full of cash.</p>
<p>Here we will focus on how a malicious program can gain control of an ATM.</p>
<h3 id="the-xfs-standard">The XFS standard</h3>
<p>So the attackers have infected the ATM system unit. What next?</p>
<p>Here again, a short explanation is required. As already mentioned, the ATM is managed by a Windows-based application. Its task is to organize interaction between the user (client or services), the processing center which sends commands to the ATM and the equipment that executes these commands. The message exchange with the processing center occurs via direct connect protocols (NDC or DDC): users communicate with the GUI while service providers are responsible for the operation of each ATM unit (gateways to these units). To send commands to the service providers and on to the equipment as well as to receive status messages, a level called XFS Manager is used in accordance with <a href="https://en.wikipedia.org/wiki/Windows_Open_Services_Architecture" target="_blank">WOSA</a>.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/1_en.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/1_en-1024x499.png" alt="Malware and non-malware ways for ATM jackpotting. Extended cut" width="604" height="294" class="aligncenter size-large wp-image-74572" /></a></p>
<p style="text-align:center;font-weight:bold"><em>ATM operations in the context of the XFS standard</em></p>
<p><a href="https://en.wikipedia.org/wiki/CEN/XFS" target="_blank">XFS</a> (CEN/XFS, and earlier WOSA/XFS), or the eXtensions for Financial Services, is a standard that provides a client-server architecture for financial applications on the Microsoft Windows platform, especially peripheral devices such as ATMs. XFS is intended to standardize software so that it can work on any equipment regardless of the manufacturer, and provides a common API for this purpose.</p>
<p>Thus, <em>any</em> application that is developed with the XFS standard in mind can control low-level objects by using only the logic described in this standard. And that application could well be the <a href="https://securelist.com/blog/research/66988/tyupkin-manipulating-atm-machines-with-malware/" target="_blank">Tyupkin</a> backdoor or any other malicious program.</p>
<p>What opportunities does XFS offer?</p>
<p>For example, the dispenser, which is the most interesting part for the attackers, can give out money without authorization. Or use of XFS on some ATM models means cybercriminals can manipulate the code to open the safe and unlock the ATM cassettes.</p>
<iframe class='youtube-player' type='text/html' width='560' height='315' src='http://www.youtube.com/embed/Uxd0TRdE6sw?version=3&#038;rel=1&#038;fs=1&#038;autohide=2&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;wmode=transparent' allowfullscreen='true' style='border:0;'></iframe>
<p style="text-align:center;font-weight:bold"><em>Exploitation of the MS08_067 vulnerability allowing execution of arbitrary code. The video was shot by experts at BlackHat Europe 2014</em></p>
<p>With regard to the card reader, XFS allows the reading and recording of data from the bank card magnetic stripe and even retrieval of the transaction history stored on the EMV card chip.</p>
<p>Of special note is the Encrypting PIN Pad (EPP). It is believed that the PIN cannot be intercepted because it is entered on the ATM PIN pad and is converted directly inside the encryption module into a PIN block (EPP contains keys to do this, two of which are in the bank&#8217;s Hardware Security Module). However, XFS allows the PIN pad to be used in two modes:</p>
<ol>
<li>Open Mode &#8211; for entering different numeric values, such as the sum to be withdrawn;</li>
<li>Secure Mode, which EPP switches to in order to enter a PIN and encryption keys.</li>
</ol>
<p>This allows cybercriminals to implement a &#8220;man-in-the-middle&#8221; (MiTM) attack. They only have to intercept the command sent from the host to the EPP to switch to Secure Mode and then to inform the device that work is continuing in Open Mode. In the reply message, the EPP will send the keystrokes as plain text – exactly what the attacker needs.</p>
<p>But what about authentication and exclusive access? And surely the standard&#8217;s specifications are inaccessible?</p>
<p>Unfortunately, this is not the case with XFS. The standard does not provide any authentication, and exclusive access to service providers is implemented, but not for security reasons. This is just a single-threaded command sending function to avoid accidentally breaking delicate hardware by simultaneously sending two identical commands.</p>
<p>Surprisingly, although it is a standard for financial applications, it doesn&#8217;t even mention security. Where can you find the specifications to check if this is true? Just try entering &#8220;ATM XFS&#8221; in any search engine and you&#8217;ll find the answer among the first few results.</p>
<h3 id="integrity-control-software">Integrity control software</h3>
<p>Banks sometimes use integrity control software on their ATMs that supposedly prevents the execution of unauthorized code based on a whitelist, controls connected devices and drives, as well as providing other useful methods which should, in theory, counter attacks.</p>
<p>But we shouldn&#8217;t forget that first of all it is software, and just like any other software, it&#8217;s not perfect. It may be vulnerable to attacks as such kiosk mode bypassing, whitelist bypassing, buffer overflow, privileges escalation to SYSTEM user, etc. As you know, existing vulnerabilities often allow cybercriminals to gain access to the operating system and to do their dirty work.</p>
<h2 id="undocumented-features">Undocumented features</h2>
<p>The bad guys may use modified utilities that were originally provided by ATM developers or manufacturers to test a machine&#8217;s operability. One of the functions of these utilities is to test the dispenser function, including the dispensing of cash. In order to carry out a test, the engineer has to confirm his legitimacy by opening the safe door or performing actions with the dispenser cassettes. The logic is simple: if you can open the safe, you have the key, i.e. you are a licensed engineer or a cash-in-transit guard. But by simply replacing a couple of bytes in the utility, the &#8220;right&#8221; people can &#8220;test&#8221; cash withdrawals without any checks.</p>
<p>Yet another way criminals have of lining their pockets is to change the denomination of banknotes dispensed by the ATM using a diagnostic utility. As a result, the attacker receives banknotes with the largest nominal value (e.g., a 100 dollar/euro banknote) while the ATM &#8220;thinks&#8221; it is dispensing the smallest of the available denominations (five or ten). It means several hundred thousand can be withdrawn from a card with a balance of just a few hundred.</p>
<h2 id="black-box">Black box</h2>
<p>So-called black box attacks are another type of attack that is getting increased <a href="http://krebsonsecurity.com/2015/01/thieves-jackpot-atms-with-black-box-attack/" target="_blank">coverage</a> in the news. On surveillance camera videos the following occurs: someone opens the service zone, connects a magic box to the ATM, closes the cabinet and leaves. A little later several people who appear to be customers approach the ATM and withdraw huge sums of money. Of course, the criminals retrieve their little device from the ATM once they have achieved their goal. Usually, these black box attacks are only discovered a few days later when the empty cassettes and the withdrawal logs don&#8217;t tally, leaving the bank employees scratching their heads.</p>
<p>However, there is no magic involved – the attackers connect a specially programmed microcomputer to the dispenser in such a way that it bypasses the security measures implemented on the host (antivirus, integrity control, full disk encryption, etc.).</p>
<h3 id="communications-insecurity">Communications insecurity</h3>
<p>As mentioned above, USB, RS232, or SDC can be used as a data transmission channel between the system unit and the devices. It&#8217;s likely that nothing will prevent the attackers from sending the necessary commands directly to the device port bypassing its service provider. The standard interfaces often do not require any specific drivers. Authorization is not required either, which basically makes these insecure proprietary protocols an easy target – just sniff and replay. The result is direct control over ATM units, the use of undocumented functions (e.g., changing the unit firmware). The criminals may also use a software or hardware traffic analyzer, installing it directly on the port of a particular device such as a card reader in order to obtain the transmitted data. And this analyzer will be difficult to detect.</p>
<p>Direct control over the dispenser means the ATM cassettes can be emptied without any entries being made in the ATM software logs.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/atm_jackpot_en_2.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/atm_jackpot_en_2.png" alt="Malware and non-malware ways for ATM jackpotting. Extended cut" width="988" height="353" class="aligncenter size-full wp-image-74535" /></a></p>
<p style="text-align:center;font-weight:bold"><em>A typical packet – the command to dispense a banknote from the first cassette of the dispenser</em></p>
<p>For those who are unaware, it may look like magic. Every great magic trick consists of three parts or acts. There are dispensing money from the cassette, opening the shutter, and presenting money to the client.</p>
<iframe class='youtube-player' type='text/html' width='560' height='315' src='http://www.youtube.com/embed/ksEmXuV324I?version=3&#038;rel=1&#038;fs=1&#038;autohide=2&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;wmode=transparent' allowfullscreen='true' style='border:0;'></iframe>
<p style="text-align:center;font-weight:bold"><em>A black box attack on an ATM. Video was prepared by experts for demonstration purposes at BlackHat Europe 2014</em></p>
<p>Hardware skimmers are &#8216;so yesterday&#8217;. Direct connection makes it possible to read and record the magnetic strip of a credit card. Traffic analyzers, which are freely available on the Internet, can also be used as a direct connection. Rumor has it that in one fairly large bank all the ATMs were used as skimmers: the attackers had found vulnerabilities in the bank&#8217;s network and installed a USB sniffer on the ATMs, allowing them to collect bank card data in plain text for five years! Who knows, maybe your card was among those affected.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/atm_jackpot_en_3.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/atm_jackpot_en_3.png" alt="Malware and non-malware ways for ATM jackpotting. Extended cut" width="641" height="53" class="aligncenter size-full wp-image-74537" /></a></p>
<p style="text-align:center;font-weight:bold"><em>The intercepted data of a Track2 card</em></p>
<h2 id="the-network">The network</h2>
<p>The connection between ATMs and the processing center can be protected in various ways. For example, using a hardware or software VPN, SSL/TLS encryption, a firewall or MAC-authentication, implemented in xDC protocols. However, all these measures often appear to be so complex for banks that they don&#8217;t bother using any network protection at all.</p>
<p>In such cases, a MiTM attack can be launched that will result in the attacker getting both <a href="http://krebsonsecurity.com/2016/02/skimmers-hijack-atm-network-cables/" target="_blank">bank card data</a> and all the money in the ATM. This requires remote access to the device, which is usually obtained by using vulnerable services that can be accessed from the Internet, as well as <a href="https://securelist.com/blog/research/68732/the-great-bank-robbery-the-carbanak-apt/" target="_blank">social engineering techniques</a>. Physical access to the network hardware, including the ATM Ethernet-cable will also suffice.</p>
<p>On the way to the real processing center a fake one pops up; it sends commands to the ATM software to dispense banknotes. Withdrawing money is possible with any card, even one that has expired or has a zero balance, as long as the fake processing center &#8220;recognizes&#8221; it. A fake processing center can be either &#8220;homemade&#8221; software that supports communication with the ATM via the xDC-protocol, or a processing center simulator originally designed to check network settings (yet another &#8220;gift&#8221; from the vendors to the cybercriminals).</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/atm_jackpot_en_4.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/atm_jackpot_en_4.png" alt="Malware and non-malware ways for ATM jackpotting. Extended cut" width="546" height="270" class="aligncenter size-full wp-image-74538" /></a></p>
<p style="text-align:center;font-weight:bold"><em>The commands for giving out 40 banknotes from the fourth cassette sent from a fake processing center and stored in the ATM software logs. They look almost like the real thing.</em></p>
<p>Where do the criminals find ATMs that can be attacked via the network? Do they scan all the nearby networks or buy the information on underground forums?</p>
<p>It turns out that you just need to enter the correct request in a search engine – <a href="https://www.shodan.io/" target="_blank">https://www.shodan.io/</a> (this Internet of Things scanner is well-known by the experts). The data collected by this scanner is usually enough to launch such attacks.</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/Shodan?src=hash">#Shodan</a> shows thousands of exposed ATMs potentially vulnerable to a network attack <a href="https://twitter.com/_Endless_Quest_">@_endless_quest_</a> <a href="https://twitter.com/hashtag/TheSAS2016?src=hash">#TheSAS2016</a> <a href="https://t.co/9E3SSYwG89">pic.twitter.com/9E3SSYwG89</a></p>
<p>&mdash; Eugene Kaspersky (@e_kaspersky) <a href="https://twitter.com/e_kaspersky/status/697078900187332608">9 февраля 2016 г.</a></p></blockquote>
<p>Or you could just take a closer look at the ATMs in retail and business centers.</p>
<p><a href="https://kasperskycontenthub.com/securelist/files/2016/04/atm_jackpot_en_5.png" class="magnificImage"><img src="https://kasperskycontenthub.com/securelist/files/2016/04/atm_jackpot_en_5-1024x570.png" alt="Malware and non-malware ways for ATM jackpotting. Extended cut" width="604" height="336" class="aligncenter size-large wp-image-74539" /></a></p>
<p style="text-align:center;font-weight:bold"><em>Sometimes the ATM system can be accessed without even opening it – all the communications are located on the outside</em></p>
<h2 id="whos-to-blame-and-what-can-be-done">Who&#8217;s to blame and what can be done</h2>
<p>This part is usually the most depressing, and here&#8217;s why.</p>
<p>When we detect a vulnerability while analyzing ATM security, we send a notification to the vendor with a description of the problem and ways to solve it. And often the answers are bewildering:</p>
<p>&#8220;The vulnerabilities are essentially normal specifications of the card readers and not unexpected. As long as the ATM is running within normal parameters, <strong>these problems cannot possibly occur</strong>.&#8221;</p>
<p>&#8220;However <strong>this vulnerability is inherent in the USB technology</strong> and is expected be mitigated by the use of appropriate physical controls on access to the ATM top box.&#8221;</p>
<p>&#8220;We regret informing you that we had decided to stop producing this model more than 3 years ago and <strong>warranties for our distributors been expired</strong>.&#8221;</p>
<p>Indeed, why should vendors bother about ATMs with expired warranties that are still used by banks around the world, and whose physical security often leaves much to be desired? Unfortunately, reality shows that manufacturers are only interested in selling new products and not in eliminating the shortcomings of existing systems, while banks lack the necessary skills to cope with the problems on their own.</p>
<p>Fortunately, some manufacturers understand the dangers of unauthorized ATM use, and release security updates. To prevent attacks on dispensers, two-way authentication and cryptography are used. It should be noted, however, that not all cryptography is correctly implemented cryptography.</p>
<p>While the existing countermeasures can protect ATMs from malware, they are powerless against black box or network attacks. A huge number of security flaws and vulnerabilities that can be exploited with minimum expertise make cash machines a prime target for those desperate to get rich illegally.</p>
<h2 id="so-is-everything-lost">So. Is everything lost?</h2>
<p>ATM manufacturers can reduce the risk of attack on cash machines.</p>
<ul>
<li>Firstly, it is necessary to revise the XFS standard with an emphasis on safety, and introduce two-way authentication between devices and legitimate software. This will help reduce the likelihood of unauthorized money withdrawals using Trojans and attackers gaining direct control over ATM units.</li>
<li>Secondly, it is necessary to implement &#8220;authenticated dispensing&#8221; to exclude the possibility of attacks via fake processing centers.</li>
<li>Thirdly, it is necessary to implement cryptographic protection and integrity control over the data transmitted between all hardware units and PC inside ATM.</li>
</ul>
<p>And what should banks do? They need to take action!</p>
<p>Encourage those who sell ATMs and software to make them secure. The manufacturer must eliminate vulnerabilities as soon as possible; it is necessary to tell them about it as often as possible. To prevent hacking of ATMs it is necessary to make use of all the available protection tools. A completed PCI DSS Self-Assessment Questionnaire is not a silver bullet and won&#8217;t protect ATMs from attacks, or banks from financial and reputational losses. Proactive protection, including regular ATM security assessment and penetration testing, is better (and often much cheaper) than  security incident and the subsequent investigation.</p>
<p>Bad guys are watching.</p>
<p>Stay safe!</p>
<p>PS: No cash machines were harmed in the preparation of this material.</p>
<p>PPS: This overview of the security issues in cash machines is not intended as a hacking guide.</p>
]]></content:encoded>
			<wfw:commentRss>http://securelist.com/analysis/publications/74533/malware-and-non-malware-ways-for-atm-jackpotting-extended-cut/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
	</channel>
</rss>